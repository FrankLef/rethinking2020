{
  "hash": "613c6dff20a898faa647e31e502ab643",
  "result": {
    "markdown": "# Adventures in Covariance {#Covariance}\n\n\n\n\n\nSome options to facilitate the computations\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#  For execution on a local, multicore CPU with excess RAM\noptions(mc.cores = parallel::detectCores())\n#  To avoid recompilation of unchanged Stan programs\nrstan_options(auto_write = TRUE)\n```\n:::\n\n\nThe default theme used by `ggplot2`\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntheme_set(ggthemes::theme_stata(base_size = 11, base_family = \"sans\", \n                                scheme = \"s2color\"))\n```\n:::\n\n\n\n## Varying slopes by construction\n\n### Simulate the population\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsimCafes <- list()\nsimCafes <- within(simCafes, {\n  # a := average morning wait time\n  # b := average difference afternoon wait time\n  Mu <- c(\"a\" = 3.5, \"b\" = -1)\n  \n  # a := std dev of intercepts\n  # b := std dev of slopes\n  sigmas <- c(\"a\" = 1, \"b\" = 0.5)\n  \n  # correlation between intercepts and slopes\n  rho <- -0.7\n  \n  cov_ab <- prod(sigmas) * rho\n})\n```\n:::\n\n\nMcElreath mentions a difficulty using the `matrix` function. He misses the \nargument `byrow` which resolve this.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# use byrow = TRUE to solve McElrath's issue\nmatrix(1:4, nrow = 2, ncol = 2, byrow = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     [,1] [,2]\n[1,]    1    2\n[2,]    3    4\n```\n:::\n:::\n\n\nwe get the covariance matrix `sigma` as follows\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsimCafes <- within(simCafes, {\n  # matrix of correlation\n  Rho <- matrix(c(1, rho, rho, 1), nrow = 2)\n  \n  # covariance matrix\n  Sigma <- diag(sigmas) %*% Rho %*% diag(sigmas)\n})\n```\n:::\n\n\nand we simulate the bivariate normal distribution\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsimCafes <- within(simCafes, {\n  n_cafes <- 20\n\n  set.seed(1409)\n  vary_effects <- MASS::mvrnorm(n = n_cafes, mu = Mu, Sigma = Sigma) |>\n    as.data.frame() |>\n    mutate(cafe = seq_len(n_cafes)) |>\n    relocate(cafe)\n})\n# glimpse(simCafes$vary_effects)\n```\n:::\n\n\nand we plot the simulated data which represents the intercept and slope\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsimCafes$vary_effects |>\n  ggplot(aes(x = a, y = b)) +\n  geom_point(shape = 1, size = 3, color = \"purple\") +\n  lapply(X = 1:5 / 5, FUN = function(x) {\n      stat_ellipse(type = \"norm\", level = x, linetype = \"dotted\", size = 0.25)}) +\n  theme(legend.position = \"none\") +\n  labs(title = sprintf(\"Distribution of intercept and slopes for %d cafes\", \n                       simCafes$n_cafes),\n       x = \"intercepts (a_cafe)\", y = \"slope (b_cafe)\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n```\n:::\n\n::: {.cell-output-display}\n![Figure 14.2](ch14_covariances_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n### Simulate the observations (visits by cafe)\n\nNow using the simulated intercepts and slopes, we create the simulated visits to each cafe.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsimCafes <- within(simCafes, {\n  n_visits <- 10  # nb of visits to each cafe by robot\n  sigma <- 0.5  # std dev within cafes\n  \n  set.seed(1409)\n  data <- vary_effects |>\n    expand(nesting(cafe, a, b), visit = seq_len(n_visits)) |>\n    mutate(afternoon = rep(0:1, times = n()/2)) |>\n    mutate(mu = a + b * afternoon) |>\n    mutate(wait = rnorm(n = n(), mean = mu, sd = sigma))\n})\n# glimpse(simCafes$vary_effects)\n# glimpse(simCafes$data)\n```\n:::\n\n\nand plot the simulated observations.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsimCafes$data |>\n  mutate(afternoon = if_else(afternoon == 0, \"M\", \"A\"),\n         day = rep(rep(1:5, each = 2), times = simCafes$n_cafes),\n         label = paste(\"cafe\", simCafes$data$cafe)) |>\n  filter(cafe %in% c(1, 5)) |>\n  ggplot(aes(x = visit, y = wait, group = day)) +\n  geom_point(aes(color = afternoon), size = 2) +\n  geom_line(color = \"green\") +\n  scale_color_manual(values = c(\"M\" = \"royalblue\", \"A\" = \"hotpink\")) +\n  theme(legend.position = \"none\") +\n  labs(title = \"Varying slopes simulation\") +\n  facet_wrap(~ label, ncol = 1)\n```\n\n::: {.cell-output-display}\n![](ch14_covariances_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n### The varying slopes model\n\n#### The model\n\n$$\n\\begin{align*}\nwait_i &\\sim \\mathcal{N}(\\mu_i, \\sigma) \\\\\n\\mu_i &= \\alpha_{cafe[i]} + \\beta_{cafe[i]} \\cdot afternoon_i \\\\\n\\begin{bmatrix}\n\\alpha_{cafe} \\\\\n\\beta_{cafe}\n\\end{bmatrix}\n&\\sim\n\\mathcal{MVNormal}(\n\\begin{bmatrix}\n\\alpha \\\\\n\\beta\n\\end{bmatrix}\n,\n\\bf{\\Sigma}\n) \\\\\n\\bf{\\Sigma} &=\n\\begin{bmatrix}\n\\sigma_{\\alpha} & 0 \\\\\n0 & \\sigma_{\\beta}\n\\end{bmatrix}\n\\begin{bmatrix}\n1 & \\rho \\\\\n\\rho & 1\n\\end{bmatrix}\n\\begin{bmatrix}\n\\sigma_{\\alpha} & 0 \\\\\n0 & \\sigma_{\\beta}\n\\end{bmatrix} \\\\\n\\alpha &\\sim \\mathcal{N}(0, 10) \\\\\n\\beta &\\sim \\mathcal{N}(0, 10) \\\\\n\\sigma &\\sim \\mathcal{HalfCauchy}(0, 1) \\\\\n\\sigma_{\\alpha} &\\sim \\mathcal{HalfCauchy}(0, 1) \\\\\n\\sigma_{\\beta} &\\sim \\mathcal{HalfCauchy}(0, 1) \\\\\n\\rho\n&\\sim \\mathcal{LKJcorr}(K=2)\n\\end{align*}\n$$\n\n#### LKJ prior\n\nWe use the `ggdist` package to illustrate the LKJ distribution.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlkj_dist <- list()\nlkj_dist <- within(lkj_dist, {\n  df <- crossing(K = 2:4, eta = 1:3, x = seq(from = -1, to = 1, by = 0.05)) |>\n    mutate(\n      id = K^eta,\n      label_K = paste0(\"K==\", K),\n      label_eta = paste0(\"eta==\", eta),\n      dens = ggdist::dlkjcorr_marginal(x = x, K = K, eta = eta)\n    )\n  p <- df |>\n    ggplot(aes(x = x, y = dens, color = id)) +\n    geom_line(size = 1) +\n    scale_y_continuous(breaks = c(0, 0.5, 1)) +\n    scale_color_paletteer_c(\"palr::sst_pal\") +\n    theme(legend.position = \"none\") +\n    facet_grid(facets = label_eta ~ label_K, scales= \"fixed\", labeller = label_parsed) +\n    labs(title = \"Lewandowski-Kurowicka-Joe Distribution\",\n         x = \"correlation\", y = \"density\")\n})\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in !is_integerish(K) || K < 2: 'length(x) = 369 > 1' in coercion to\n'logical(1)'\n```\n:::\n\n```{.r .cell-code}\n# glimpse(lkj_dist$df)\nlkj_dist$p\n```\n\n::: {.cell-output-display}\n![Figure 14.3](ch14_covariances_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntictoc::tic(msg = sprintf(\"run time of %s, use the cache.\", \"60 secs.\"))\nfit14_01 <- xfun::cache_rds({\n  out <- brm(\n    data = simCafes$data,\n    family = gaussian,\n    formula = wait ~ 1 + afternoon + (1 + afternoon | cafe),\n    prior = c(\n      prior(normal(5, 2), class = Intercept),\n      prior(normal(-1, 0.5), class = b),\n      prior(exponential(1), class = sd),\n      prior(exponential(1), class = sigma),\n      prior(lkj(2), class = cor)),\n    sample_prior = TRUE,\n    iter = 1000, warmup = 500, chains = 2,\n    cores = detectCores(), seed = 1423)\n  add_criterion(out, c(\"loo\", \"waic\"))},\n  file = \"ch14_fit14_01\", rerun = FALSE)\ntictoc::toc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nrun time of 60 secs., use the cache.: 0.14 sec elapsed\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npost14_01 <- list()\npost14_01 <- within(post14_01, {\n  prior <- prior_draws(x = fit14_01)\n  \n  post <- tidy_draws(model = fit14_01)\n  \n  # dataframe of correlations to plot\n  corr = data.frame(\"value\" = c(prior$cor_cafe, post$cor_cafe__Intercept__afternoon),\n                    \"id\" = c(rep(\"prior\", nrow(prior)), rep(\"post\", nrow(post))))\n\n  coefs <- fit14_01 |>\n    spread_draws(b_Intercept, b_afternoon, r_cafe[cafe, term]) |>\n    pivot_wider(id_cols = c(\"b_Intercept\", \"b_afternoon\", \"cafe\"),\n                names_from = \"term\", values_from = \"r_cafe\") |>\n    group_by(cafe) |>\n    summarize(b_Intercept = mean(b_Intercept), b_afternoon = mean(b_afternoon),\n              r_afternoon = mean(afternoon), r_Intercept = mean(Intercept)) |>\n    mutate(Intercept = b_Intercept + r_Intercept,\n           afternoon = b_afternoon + r_afternoon) |>\n    select(cafe, Intercept, afternoon) |>\n    identity()\n  all <- simCafes$vary_effects |>\n    rename(\"Intercept\" = a, \"afternoon\" = b)\n  \n  all <- bind_rows(\"real\" = all, \"post\" = coefs, .id = \"id\")\n})\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `gather_()` was deprecated in tidyr 1.2.0.\nℹ Please use `gather()` instead.\nℹ The deprecated feature was likely used in the tidybayes package.\n  Please report the issue at <https://github.com/mjskay/tidybayes/issues/new>.\n```\n:::\n\n```{.r .cell-code}\n# glimpse(post14_01$post)\n# glimpse(post14_01$coefs)\n# glimpse(post14_01$all)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot14_01 <- list()\nplot14_01 <- within(plot14_01, {\n  cor <- post14_01$corr |> \n    ggplot(aes(x = value, color = id, linetype = id)) +\n    geom_density(size = 1, adjust = 0.75) +\n    scale_color_manual(values = c(\"prior\" = \"black\", \"post\" = \"blue\")) +\n    scale_linetype_manual(values = c(\"prior\" = \"longdash\", \"post\" = \"solid\")) +\n    theme(legend.position = c(0.8, 0.8), legend.title = element_blank()) +\n    labs(title = \"Posterior and Prior distribution of the correlation\",\n         x = \"correlation\")\n})\nplot14_01$cor\n```\n\n::: {.cell-output-display}\n![Figure 14.4](ch14_covariances_files/figure-html/ch14_plot14_01-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npred14_01 <- list()\npred14_01 <- within(pred14_01, {\n  pred_df <- simCafes$data |>\n    group_by(cafe, afternoon) |>\n    summarise(mwait = mean(wait)) |>\n    add_predicted_draws(object = fit14_01) |>\n    mean_qi(.width = 0.89) |>\n    mutate(term = if_else(afternoon == 0, \"Intercept\", \"afternoon\"))\n  \n  real <- pred_df |>\n    select(cafe, term, mwait) |>\n    pivot_wider(id_cols = cafe, names_from = term, values_from = mwait)\n  \n  pred <- pred_df |>\n    select(cafe, term, .prediction) |>\n    pivot_wider(id_cols = cafe, names_from = term, values_from = .prediction)\n  \n  all <- bind_rows(\"real\" = real, \"pred\" = pred, .id = \"id\")\n})\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'cafe'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\n# glimpse(pred14_01$all)\n# glimpse(simCafes$data)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot14_01 <- within(plot14_01, {\n  coefs <- post14_01$all |>\n    ggplot(mapping = aes(x = Intercept, y = afternoon, group = cafe, color = id)) +\n    lapply(X = 1:5 / 5, FUN = function(x) {\n      stat_ellipse(data = post14_01$all, mapping = aes(x = Intercept, y = afternoon),\n                   inherit.aes = FALSE,\n                   geom = \"polygon\", type = \"norm\", level = x, linewidth = 1/5,\n                 color = \"dodgerblue\", fill = \"transparent\")}) +\n    geom_point() +\n    geom_line(color = \"black\") +\n    scale_color_paletteer_d(\"awtools::spalette\", direction = 1) +\n    theme(legend.position = c(0.2, 0.2),\n          legend.title = element_blank()) +\n    labs(title = \"Coefficients and shrinkage\",\n         x = \"Intercept\", y = \"Slope\")\n    \n  \n  wait <- pred14_01$all |>\n    ggplot(mapping = aes(x = Intercept, y = afternoon, group = cafe, color = id)) +\n    lapply(X = 1:5 / 5, FUN = function(x) {\n      stat_ellipse(data = pred14_01$all, mapping = aes(x = Intercept, y = afternoon),\n                   inherit.aes = FALSE,\n                   geom = \"polygon\", type = \"norm\", level = x, linewidth = 1/5,\n                 color = \"dodgerblue\", fill = \"transparent\")}) +\n    geom_point() +\n    geom_line(color = \"black\") +\n    scale_color_paletteer_d(\"awtools::spalette\", direction = -1) +\n    theme(legend.position = c(0.8, 0.2),\n          legend.title = element_blank()) +\n    labs(title = \"Waiting time and shrinkage\",\n         x = \"morning wait\", y = \"afternoon wait\")\n})\n# plot14_01$coefs\nwrap_plots(plot14_01[c(\"coefs\", \"wait\")]) +\n  plot_annotation(title = \"Shrinkage in two dimensions\")\n```\n\n::: {.cell-output-display}\n![Figure 14.5](ch14_covariances_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n## Advanced varying slopes\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(chimpanzees)\ndataChimp <- chimpanzees |>\n  mutate(block = factor(block),\n         actor = factor(actor),\n         treatment = factor(1 + prosoc_left + 2 * condition, levels = 1:4,\n                            labels = c(\"AR\", \"AL\", \"PR\", \"PL\")))\nrm(chimpanzees)\ndataChimp |>\n  skim() |>\n  mutate(across(.cols = where(is.numeric), .fns = round, digits = 2))\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |          |\n|:------------------------|:---------|\n|Name                     |dataChimp |\n|Number of rows           |504       |\n|Number of columns        |9         |\n|_______________________  |          |\n|Column type frequency:   |          |\n|factor                   |3         |\n|numeric                  |6         |\n|________________________ |          |\n|Group variables          |None      |\n\n\n**Variable type: factor**\n\n|skim_variable | n_missing| complete_rate|ordered | n_unique|top_counts                         |\n|:-------------|---------:|-------------:|:-------|--------:|:----------------------------------|\n|actor         |         0|             1|FALSE   |        7|1: 72, 2: 72, 3: 72, 4: 72         |\n|block         |         0|             1|FALSE   |        6|1: 84, 2: 84, 3: 84, 4: 84         |\n|treatment     |         0|             1|FALSE   |        4|AR: 126, AL: 126, PR: 126, PL: 126 |\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|  mean|    sd| p0|   p25|  p50|   p75| p100|hist  |\n|:-------------|---------:|-------------:|-----:|-----:|--:|-----:|----:|-----:|----:|:-----|\n|recipient     |       252|           0.5|  5.00|  2.00|  2|  3.00|  5.0|  7.00|    8|▇▃▃▃▇ |\n|condition     |         0|           1.0|  0.50|  0.50|  0|  0.00|  0.5|  1.00|    1|▇▁▁▁▇ |\n|trial         |         0|           1.0| 36.50| 20.80|  1| 18.75| 36.5| 54.25|   72|▇▇▇▇▇ |\n|prosoc_left   |         0|           1.0|  0.50|  0.50|  0|  0.00|  0.5|  1.00|    1|▇▁▁▁▇ |\n|chose_prosoc  |         0|           1.0|  0.57|  0.50|  0|  0.00|  1.0|  1.00|    1|▆▁▁▁▇ |\n|pulled_left   |         0|           1.0|  0.58|  0.49|  0|  0.00|  1.0|  1.00|    1|▆▁▁▁▇ |\n:::\n:::\n\n\n#### The model\n\n$$\n\\begin{align*}\nL_i &\\sim \\mathcal{Binomial}(1, p_i) \\\\\nlogit(p_i) &\\sim \\gamma_{treatment[i]} + \\alpha_{actor[i], treatment[i]} + \\beta_{block[i], treatment[i]} \\\\\n\\gamma_{treatment[i]} &\\sim \\mathcal{N}(0, 1), \\, \\text{for } i = 1 \\ldots 4 \\\\\n\n\n\\begin{bmatrix}\n\\alpha_{j, 1} \\\\\n\\alpha_{j, 2} \\\\\n\\alpha_{j, 3} \\\\\n\\alpha_{j, 4}\n\\end{bmatrix}\n&\\sim\n\\mathcal{MVNormal}(\n\\begin{bmatrix}\n0 \\\\\n0 \\\\\n0 \\\\\n0\\\\\n\\end{bmatrix}\n,\n\\bf{\\Sigma_{actor}}\n) \\\\\n\n\n\\begin{bmatrix}\n\\beta_{j, 1} \\\\\n\\beta_{j, 2} \\\\\n\\beta_{j, 3} \\\\\n\\beta_{j, 4}\n\\end{bmatrix}\n&\\sim\n\\mathcal{MVNormal}(\n\\begin{bmatrix}\n0 \\\\\n0 \\\\\n0 \\\\\n0 \\\\\n\\end{bmatrix}\n,\n\\bf{\\Sigma_{block}}\n) \\\\\n\n\n\n\\bf{\\Sigma_{actor}} &=\n\\begin{bmatrix}\n\\sigma_{factor} & 0 \\\\\n0 & \\sigma_{factor}\n\\end{bmatrix}\n\\cdot\n\\begin{bmatrix}\n1 & \\rho_{factor} \\\\\n\\rho_{factor} & 1\n\\end{bmatrix}\n\\cdot\n\\begin{bmatrix}\n\\sigma_{factor} & 0 \\\\\n0 & \\sigma_{factor}\\\\\n\\end{bmatrix} \\\\\n\n\n\n\\bf{\\Sigma_{block}} &=\n\\begin{bmatrix}\n\\sigma_{block} & 0 \\\\\n0 & \\sigma_{block}\n\\end{bmatrix}\n\\cdot\n\\begin{bmatrix}\n1 & \\rho_{block} \\\\\n\\rho_{block} & 1\n\\end{bmatrix}\n\\cdot\n\\begin{bmatrix}\n\\sigma_{block} & 0 \\\\\n0 & \\sigma_{block}\\\\\n\\end{bmatrix} \\\\\n\n\n\n\\sigma_{actor, j} &\\sim \\mathcal{Exponential}(1), \\, \\text{for } i = 1 \\ldots 4 \\\\\n\\sigma_{block, j} &\\sim \\mathcal{Exponential}(1), \\, \\text{for } i = 1 \\ldots 4 \\\\\n\n\n\\rho_{actor}, \\rho_{block} &\\sim \\mathcal{LKJcorr}(2)\n\n\\end{align*}\n$$\n\nWe don't do model m14.2 since it is only done to illustrate centralized vs\nnon-centralized parametrization and that `brms` uses only non-centralized\nparametrization.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntictoc::tic(msg = sprintf(\"run time of %s, use the cache.\", \"80 secs.\"))\nfit14_03 <- xfun::cache_rds({\n  out <- brm(\n    data = dataChimp,\n    family = bernoulli,\n    formula = bf(pulled_left ~ 0 + treatment + (0 + treatment | actor) + (0 + treatment | block)),\n    prior = c(\n      prior(normal(0, 1), class = b),\n      prior(exponential(1), class = sd, group = actor),\n      prior(exponential(1), class = sd, group = block),\n      prior(lkj(2), class = cor, group = actor),\n      prior(lkj(2), class = cor, group = block)),\n    iter = 1000, warmup = 500, chains = 2,\n    cores = detectCores(), seed = 1427)\n  add_criterion(out, c(\"loo\", \"waic\"))},\n  file = \"ch14_fit14_03\", rerun = FALSE)\ntictoc::toc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nrun time of 80 secs., use the cache.: 0.14 sec elapsed\n```\n:::\n:::\n\nThe plot is slightly different than what McElreath has. The open circle\nrepresent the actual results and the solid circles are the predicted mean.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot14_03 <- list()\nplot14_03 <- within(plot14_03, {\n\n  df <- dataPredicted <- dataChimp |>\n    group_by(actor, treatment, block) |>\n    summarize(prop = mean(pulled_left)) |>\n    ungroup() |>\n    add_epred_draws(fit14_03) |>\n    summarize(prop = mean(prop),\n              mean_qi(.epred, .width = 0.89) ) |>\n    rename(\".epred\" = y, \".lower\" = ymin, \".upper\" = ymax)\n  \n  # every block is different but, for plotting, we use the average of the blocks\n  df <- df |>\n    group_by(actor, treatment) |>\n    summarize(\n      prop = mean(prop),\n      .epred = mean(.epred),\n      .lower = mean(.lower),\n      .upper = mean(.upper)) |>\n    mutate(label = paste(\"actor\", actor)) |>\n    mutate(condition = if_else(substring(treatment, 1, 1) == \"A\", \"alone\", \"partner\"),\n           condition = as.factor(condition),\n           prosoc_left = if_else(substring(treatment, 2, 2) == \"R\", \"right\", \"left\"),\n           prosoc_left = as.factor(prosoc_left)) |>\n    mutate(label = paste(\"actor\", actor))\n    \n    \n    \n  p <- df |>\n    ggplot(aes(x = treatment, y = .epred,\n                             group = prosoc_left, color = prosoc_left,\n                             fill = prosoc_left)) +\n    geom_line(linetype = \"solid\", size = 1) +\n    geom_point(shape = 16, size = 3) +\n    geom_line(aes(y = prop), linetype = \"solid\", size = 1) +\n    geom_point(aes(y = prop), shape = 1, size = 3) +\n    geom_errorbar(aes(ymin = .lower, ymax = .upper), width = 1/3) +\n    geom_hline(yintercept = 0.5, color = \"brown\", linetype = 2) +\n    scale_y_continuous(labels = scales::label_percent()) +\n    scale_color_paletteer_d(\"jcolors::pal9\") +\n    coord_cartesian(ylim = c(0, 1)) +\n    theme(legend.position = \"bottom\") +\n    labs(title = \"Posterior expected predictions with 89% CI\",\n         subtitle = \"Open circles are actual results, solid circles are mean predictions.\",\n         x = NULL, y = \"proportion pulled left\") +\n    facet_grid(. ~ label)\n})\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'actor', 'treatment'. You can override\nusing the `.groups` argument.\n`summarise()` has grouped output by 'actor', 'treatment', 'block', 'prop'. You\ncan override using the `.groups` argument.\n`summarise()` has grouped output by 'actor'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\n# glimpse(plot14_03$df)\nplot14_03$p\n```\n\n::: {.cell-output-display}\n![Figure 14.7](ch14_covariances_files/figure-html/ch14_plot14_03-1.png){width=672}\n:::\n:::\n\n\n## Instruments and Causal designs\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggdag::dagify(E ~ U, W ~ U, W ~ E) |>\n    ggdag::ggdag_classic(layout = \"sugiyama\", text_col = \"royalblue\") +\n    ggdag::theme_dag_blank(\n      panel.background = element_rect(fill = \"snow\", color = \"snow\"))\n```\n\n::: {.cell-output-display}\n![](ch14_covariances_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n> In causal terms, an instrument variable is a variable that acts like a natural\nexperiment  on the exposure $E$.\n\nIn mathematical terms the instrumental variable $Q$ is characterized as follows:\n\n1. Independent of $U$, i.e. $Q \\perp\\!\\!\\!\\perp U$\n2. Not independent of $E$, i.e. $Q \\not\\!\\perp\\!\\!\\!\\perp E$\n3. Has no effect on $W$ except through $E$, also called the **exclusion condition**\n\n\n> The exclusion restriction cannot be tested, and it is often implausible.\n\nIn the education and wage example, the simplest instrument variable $Q$ would be\nas follows\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggdag::dagify(E ~ U + Q, W ~ U, W ~ E) |>\n    ggdag::ggdag_classic(layout = \"sugiyama\", text_col = \"royalblue\") +\n    ggdag::theme_dag_blank(\n      panel.background = element_rect(fill = \"snow\", color = \"snow\"))\n```\n\n::: {.cell-output-display}\n![](ch14_covariances_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nWe now use a simulation to illustrate.\n\n> With real data, you never know what the right anser is. This is h=why studying\nsimulated examples is so important.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsimInstrument <- list()\nsimInstrument <- within(simInstrument, {\n  n = 500L\n  U <- rnorm(n = n)\n  Q <- sample(x = 1:4, size = n, replace = TRUE)\n  E <- rnorm(n = n, mean = U + Q)\n  # we assume that the true influence of E (education)\n  #  on W (wage) is zero. Just for the sake of the example.\n  W <- rnorm(n = n, mean = U + 0 * E)\n  df <- data.frame(\n    \"W\" = scale(W),\n    \"E\" = scale(E),\n    \"Q\" = scale(Q)\n  )\n})\n# glimpse(simInstrument$df)\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntictoc::tic(msg = sprintf(\"run time of %s, use the cache.\", \"60 secs.\"))\nfit14_04 <- xfun::cache_rds({\n  out <- brm(\n    data = simInstrument$df,\n    family = gaussian,\n    formula = W ~ 1 + E,\n    prior = c(\n      prior(normal(0, 0.2), class = Intercept),\n      prior(normal(0, 0.5), class = b),\n      prior(exponential(1), class = sigma)),\n    iter = 1000, warmup = 500, chains = 2,\n    cores = detectCores(), seed = 1429)\n  add_criterion(out, c(\"loo\", \"waic\"))},\n  file = \"ch14_fit14_04\", rerun = FALSE)\ntictoc::toc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nrun time of 60 secs., use the cache.: 0.13 sec elapsed\n```\n:::\n:::\n\nwhich gives us the results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummarize_draws(fit14_04, \"mean\", \"sd\", ~quantile(.x, probs = c(0.055, 0.945)),\n                default_convergence_measures()) |>\n  filter(!grepl(\"^lp\", x = variable)) |>\n  mutate(across(.cols = where(is.numeric), .fns = round, digits = 2),\n         across(.cols = starts_with(\"ess\"), .fns = as.integer))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 8\n  variable     mean    sd `5.5%` `94.5%`  rhat ess_bulk ess_tail\n  <chr>       <dbl> <dbl>  <dbl>   <dbl> <dbl>    <int>    <int>\n1 b_Intercept  0     0.04  -0.06    0.06     1     1103      636\n2 b_E          0.4   0.04   0.34    0.46     1      970      696\n3 sigma        0.92  0.03   0.87    0.96     1     1172      843\n```\n:::\n:::\n\n\nThe value $b_E$ should have been close to zero. The oncorrect value is caused \nby the confounding effect of $U$.\n\nNow, lets see what happens when we include the instrumental variable $Q$.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntictoc::tic(msg = sprintf(\"run time of %s, use the cache.\", \"60 secs.\"))\nfit14_05 <- xfun::cache_rds({\n  out <- brm(\n    data = simInstrument$df,\n    family = gaussian,\n    formula = W ~ 1 + E + Q,\n    prior = c(\n      prior(normal(0, 0.2), class = Intercept),\n      prior(normal(0, 0.5), class = b),\n      prior(exponential(1), class = sigma)),\n    iter = 1000, warmup = 500, chains = 2,\n    cores = detectCores(), seed = 1429)\n  add_criterion(out, c(\"loo\", \"waic\"))},\n  file = \"ch14_fit14_05\", rerun = FALSE)\ntictoc::toc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nrun time of 60 secs., use the cache.: 0.11 sec elapsed\n```\n:::\n:::\n\n\n\nwhich gives us the results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummarize_draws(fit14_05, \"mean\", \"sd\", ~quantile(.x, probs = c(0.055, 0.945)),\n                default_convergence_measures()) |>\n  filter(!grepl(\"^lp\", x = variable)) |>\n  mutate(across(.cols = where(is.numeric), .fns = round, digits = 2),\n         across(.cols = starts_with(\"ess\"), .fns = as.integer))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 4 × 8\n  variable     mean    sd `5.5%` `94.5%`  rhat ess_bulk ess_tail\n  <chr>       <dbl> <dbl>  <dbl>   <dbl> <dbl>    <int>    <int>\n1 b_Intercept  0     0.04  -0.06    0.06  1         896      646\n2 b_E          0.6   0.05   0.52    0.68  1.01      941      577\n3 b_Q         -0.35  0.05  -0.43   -0.27  1         843      650\n4 sigma        0.87  0.03   0.83    0.92  1         872      737\n```\n:::\n:::\n\n\nThe results are now even more confusing as the influence of $Q$ makes the effect\nof $E$ difficult to evaluate on its own.\n\nSo lets use the instrumental variable $Q$ again but taking into account the\ncovariance of $E$ and $Q$. That is, we express the model as a *multivariate \nstatistical model as follows\n\n$$\n\\begin{align*}\n\\begin{bmatrix}\nW_i \\\\\nE_i \\\\\n\\end{bmatrix}\n&\\sim\n\\mathcal{MVNormal}(\n\\begin{bmatrix}\n\\mu_{W, i} \\\\\n\\mu_{E, i}\n\\end{bmatrix}, \n\\bf{\\Sigma}\n) \\\\\n\\mu_{W, i} &= \\alpha_W + \\beta_{EW}E_i \\\\\n\\mu_{E, i} &= \\alpha_E + \\beta_{QE}Q_i \\\\\n\\bf{\\Sigma} &= \n\\begin{bmatrix}\n\\sigma_W & 0 \\\\\n0 & \\sigma_E\n\\end{bmatrix}\n\\cdot\n\\begin{bmatrix}\n1 & \\rho \\\\\n\\rho & 1\n\\end{bmatrix}\n\\cdot\n\\begin{bmatrix}\n\\sigma_W & 0 \\\\\n0 & \\sigma_E\n\\end{bmatrix}\n\\\\\n\\alpha_W, \\alpha_E &\\sim \\mathcal{N}(0, 0.2) \\\\\n\\beta_{EW}, \\beta_{QE} &\\sim \\mathcal{N}(0, 0.5) \\\\\n\\sigma_W, \\sigma_E &\\sim \\mathcal{Exponential}(1) \\\\\n\\rho &\\sim \\mathcal{LKJ}(2)\n\\end{align*}\n$$\n\n\n\n::: {.cell}\n\n:::\n\nand the final fit is\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntictoc::tic(msg = sprintf(\"run time of %s, use the cache.\", \"90 secs.\"))\nfit14_06 <- xfun::cache_rds({\n  out <- brm(\n    data = simInstrument$df,\n    family = gaussian,\n    formula = bf(W ~ 1 + E) + bf(E ~ 1 + Q),\n    prior = c(\n      prior(normal(0, 0.2), class = Intercept, resp = E),\n      prior(normal(0, 0.5), class = b, resp = E),\n      prior(exponential(1), class = sigma, resp = E),\n      prior(normal(0, 0.2), class = Intercept, resp = W),\n      prior(normal(0, 0.5), class = b, resp = W),\n      prior(exponential(1), class = sigma, resp = W),\n      prior(lkj(2), class = rescor)),\n    iter = 1000, warmup = 500, chains = 2,\n    cores = detectCores(), seed = 1429)\n  add_criterion(out, c(\"loo\", \"waic\"))},\n  file = \"ch14_fit14_06\", rerun = FALSE)\ntictoc::toc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nrun time of 90 secs., use the cache.: 0.14 sec elapsed\n```\n:::\n:::\n\n\n\nwhich gives us the results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummarize_draws(fit14_06, \"mean\", \"sd\", ~quantile(.x, probs = c(0.055, 0.945)),\n                default_convergence_measures()) |>\n  filter(!grepl(\"^lp\", x = variable)) |>\n  mutate(across(.cols = where(is.numeric), .fns = round, digits = 2),\n         across(.cols = starts_with(\"ess\"), .fns = as.integer))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 × 8\n  variable       mean    sd `5.5%` `94.5%`  rhat ess_bulk ess_tail\n  <chr>         <dbl> <dbl>  <dbl>   <dbl> <dbl>    <int>    <int>\n1 b_W_Intercept  0     0.04  -0.07    0.07  1         899      640\n2 b_E_Intercept  0     0.04  -0.06    0.06  1         823      701\n3 b_W_E          0     0.08  -0.13    0.13  1.01      452      738\n4 b_E_Q          0.58  0.04   0.52    0.64  1         752      727\n5 sigma_W        1     0.04   0.93    1.07  1.01      513      738\n6 sigma_E        0.82  0.02   0.78    0.86  1         895      662\n7 rescor__W__E   0.49  0.06   0.39    0.58  1.01      444      731\n```\n:::\n:::\n\n\n\n## Social relations as correlated varying effects\n\n### Data\n\nThe research can be find in this [paper](https://research-information.bris.ac.uk/ws/portalfiles/portal/41942591/koster2014sn.pdf).\nHowever I could not find what the variable $dlndist$ is. I suppose it it the log\nof some distance . . but why is it negative? It doesn't matter, it is only used\nto color the edges of the network and not in the analysis per se.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(KosterLeckie, package = \"rethinking\")\ndataKL <- list(\n  \"dyads\" = kl_dyads,\n  \"houses\" = kl_households)\nrm(list = c(\"kl_dyads\", \"kl_households\"))\ndataKL$dyads <- dataKL$dyads |>\n  # we only use these variable\n  select(hidA, hidB, did, giftsAB, giftsBA, offset, dlndist) |>\n  mutate(hidA = factor(hidA),\n         hidB = factor(hidB),\n         did = factor(did))\n```\n:::\n\n\nThe data set can be summarized with the `skimr` package\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(dataKL$dyads)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"hidA\"    \"hidB\"    \"did\"     \"giftsAB\" \"giftsBA\" \"offset\"  \"dlndist\"\n```\n:::\n\n```{.r .cell-code}\ndataKL$dyads |> skim() |>\n  select(-n_missing, -complete_rate) |>\n  mutate(across(.cols = where(is.numeric), .fns = round, digits = 2))\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |             |\n|:------------------------|:------------|\n|Name                     |dataKL$dyads |\n|Number of rows           |300          |\n|Number of columns        |7            |\n|_______________________  |             |\n|Column type frequency:   |             |\n|factor                   |3            |\n|numeric                  |4            |\n|________________________ |             |\n|Group variables          |None         |\n\n\n**Variable type: factor**\n\n|skim_variable |ordered | n_unique|top_counts                     |\n|:-------------|:-------|--------:|:------------------------------|\n|hidA          |FALSE   |       24|1: 24, 2: 23, 3: 22, 4: 21     |\n|hidB          |FALSE   |       24|25: 24, 24: 23, 23: 22, 22: 21 |\n|did           |FALSE   |      300|1: 1, 2: 1, 3: 1, 4: 1         |\n\n\n**Variable type: numeric**\n\n|skim_variable |  mean|    sd|    p0|   p25|   p50|   p75|   p100|hist  |\n|:-------------|-----:|-----:|-----:|-----:|-----:|-----:|------:|:-----|\n|giftsAB       |  3.87|  7.97|  0.00|  0.00|  1.00|  4.00|  75.00|▇▁▁▁▁ |\n|giftsBA       |  5.70| 11.47|  0.00|  1.00|  2.00|  6.00| 110.00|▇▁▁▁▁ |\n|offset        | -0.13|  0.21| -1.24| -0.11| -0.02| -0.01|   0.00|▁▁▁▁▇ |\n|dlndist       | -2.26|  0.59| -4.07| -2.58| -2.18| -1.85|  -1.03|▁▂▆▇▂ |\n:::\n:::\n\n\nWe can visualize the distribution of dyadic gifts using a scatter plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataKL$dyads |> ggplot(aes(x = giftsAB, y = giftsBA)) +\n  geom_point(color = \"darkblue\") +\n  geom_abline(slope = 1, intercept = 0, linetype = 2, color = \"royalblue\") +\n  coord_equal(ratio = 1, xlim = c(0, 120), ylim = c(0, 120)) +\n  labs(title = \"Distribution of dyadic gifts\")\n```\n\n::: {.cell-output-display}\n![Figure 14.8](ch14_covariances_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\nand since this a social network then we can visualize the network with the\n`ggnetwork` package.For details see [ggnetwork](https://cran.r-project.org/web/packages/ggnetwork/vignettes/ggnetwork.html).\n\nFirst we need to create an igraph object. See [igraph](https://igraph.org/r/doc/graph_from_data_frame.html)\nfor details.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# first we need to create an igraph\nnetKL <- list()\nnetKL <- within(netKL, {\n  # the igraph object\n  g <- dataKL$dyads |>\n    mutate(giftsSum = abs(giftsAB - giftsBA)) |>\n    igraph::graph_from_data_frame(directed = TRUE,\n                                  vertices = dataKL$houses)\n  # create the network dataframe\n  df <- ggnetwork(g, layout = igraph::layout_in_circle(g))\n  # plot the network\n  p <- ggplot(df, aes(x = x, y = y, xend = xend, yend = yend)) +\n    geom_edges(aes(color = dlndist)) +\n    geom_nodes(aes(size = hwealth), color = \"brown\") +\n    scale_color_paletteer_c(\"oompaBase::jetColors\", direction = -1) +\n    scale_size_continuous(range = c(1, 6)) +\n    theme_blank() +\n    labs(title = \"The KosterLeckie Network\")\n})\n# glimpse(netKL$df)\nnetKL$p\n```\n\n::: {.cell-output-display}\n![](ch14_covariances_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n\n### Model\n\n$$\n\\begin{align*}\n\\begin{bmatrix}\ny_{a \\rightarrow b} \\\\\ny_{b \\rightarrow a} \\\\\n\\end{bmatrix}\n&\\sim\n\\begin{bmatrix}\n\\mathcal{Poisson}(\\lambda_{AB}) \\\\\n\\mathcal{Poisson}(\\lambda_{BA}) \\\\\n\\end{bmatrix} \\\\\n\\log{\\lambda_{AB}} &= \\alpha + g_A + r_B + d_{AB} \\\\\n\\log{\\lambda_{BA}} &= \\alpha + g_B + r_A + d_{BA} \\\\\n\\begin{bmatrix}\ng_i \\\\\nr_i \\\\\n\\end{bmatrix}\n&\\sim\n\\mathcal{MVNormal}(\n\\begin{bmatrix}\n0 \\\\\n0\n\\end{bmatrix},\n\\Sigma_{gr}\n) \\\\\n\\begin{bmatrix}\nd_{ij} \\\\\nd_{ji} \\\\\n\\end{bmatrix}\n&\\sim\n\\mathcal{MVNormal}(\n\\begin{bmatrix}\n0 \\\\\n0\n\\end{bmatrix},\n\\Sigma_d\n) \\\\\n\n\\Sigma_{gr} &= \n\\begin{bmatrix}\n\\sigma_g & 0 \\\\\n0 & \\sigma_r &\n\\end{bmatrix}\n\\cdot\n\\begin{bmatrix}\n1 & \\rho_{gr} \\\\\n\\rho_{gr} & 1 \\\\\n\\end{bmatrix}\n\\cdot\n\\begin{bmatrix}\n\\sigma_g & 0 \\\\\n0 & \\sigma_r \\\\\n\\end{bmatrix} \\\\\n\n\\Sigma_d &= \n\\begin{bmatrix}\n\\sigma_d & 0 \\\\\n0 & \\sigma_d &\n\\end{bmatrix}\n\\cdot\n\\begin{bmatrix}\n1 & \\rho_d \\\\\n\\rho_d & 1 \\\\\n\\end{bmatrix}\n\\cdot\n\\begin{bmatrix}\n\\sigma_d & 0 \\\\\n0 & \\sigma_d \\\\\n\\end{bmatrix} \\\\\n\n\\sigma_d, \\sigma_g, \\sigma_r &\\sim \\mathcal{Exponential}(1) \\\\\n\n\n\\rho_{gr}, \\rho_d &\\sim \\mathcal{LKJ}(4)\n\\end{align*}\n$$\n\nKurtz says that there is no known way to use `brms`. The package `bisonR` \nthat specializes in social networks and uses `brms`.\nIt can be found at [bison](https://github.com/JHart96/bisonR) with a useful \nvignette at [vignette](https://jordanhart.co.uk/bisonR/articles/getting_started.html).\n\n::: {.callout-note}\nThis section is skipped. But one day, it might be interesting to do it with the\n`bisonR` package.\n:::\n\n## Continuous categories and the Gaussian process\n\n### Spatial autocorrelation in Oceanic tools\n\n#### Data\n\nThe observed data is as follows. All the data is put in 2 dataframes to be able\nto analyse it as graph data.\n\n* nodes_df: The data related to the nodes\n* edges_df: The data related to the edges, e.g. the distance between the cultures\n\nFirst we define the nodes dataframes\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(Kline2)\ndataKline <- list()\ndataKline <- within(dataKline, {\n  nodes_df <- Kline2 |>\n    mutate(log_pop_s = as.vector(scale(logpop)),\n           cid = factor(contact, levels = c(\"low\", \"high\"))) |>\n    # latitude and longitude coverted to thousands of km\n    # using the average distance at the equator\n    mutate(lat_pos = lat * 0.11132,\n           lon2_pos = lon2 * 0.11132)\n  })\nrm(Kline2)\ndataKline$nodes_df |>\n  skim() |>\n  select(-n_missing, -complete_rate) |>\n  mutate(across(.cols = where(is.numeric), .fns = round, digits = 2))\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |                   |\n|:------------------------|:------------------|\n|Name                     |dataKline$nodes_df |\n|Number of rows           |10                 |\n|Number of columns        |13                 |\n|_______________________  |                   |\n|Column type frequency:   |                   |\n|factor                   |3                  |\n|numeric                  |10                 |\n|________________________ |                   |\n|Group variables          |None               |\n\n\n**Variable type: factor**\n\n|skim_variable |ordered | n_unique|top_counts                     |\n|:-------------|:-------|--------:|:------------------------------|\n|culture       |FALSE   |       10|Chu: 1, Haw: 1, Lau: 1, Mal: 1 |\n|contact       |FALSE   |        2|hig: 5, low: 5                 |\n|cid           |FALSE   |        2|low: 5, hig: 5                 |\n\n\n**Variable type: numeric**\n\n|skim_variable |     mean|       sd|      p0|     p25|     p50|      p75|      p100|hist  |\n|:-------------|--------:|--------:|-------:|-------:|-------:|--------:|---------:|:-----|\n|population    | 34109.10| 84793.03| 1100.00| 3897.75| 7700.00| 12050.00| 275000.00|▇▁▁▁▁ |\n|total_tools   |    34.80|    17.85|   13.00|   22.50|   30.50|    42.25|     71.00|▇▃▃▂▂ |\n|mean_TU       |     4.83|     1.14|    3.20|    4.00|    4.85|     5.30|      6.60|▅▅▇▂▅ |\n|lat           |    -5.22|    13.51|  -21.20|  -15.30|   -9.70|     5.03|     19.90|▇▇▂▅▂ |\n|lon           |    93.71|   137.16| -175.20|  140.30|  151.25|   167.12|    178.10|▂▁▁▁▇ |\n|lon2          |   -14.29|    19.89|  -41.90|  -28.93|  -13.25|    -4.23|     24.40|▇▂▇▅▂ |\n|logpop        |     8.98|     1.53|    7.00|    8.26|    8.95|     9.39|     12.52|▃▇▃▁▂ |\n|log_pop_s     |     0.00|     1.00|   -1.29|   -0.47|   -0.02|     0.27|      2.32|▃▇▃▁▂ |\n|lat_pos       |    -0.58|     1.50|   -2.36|   -1.70|   -1.08|     0.56|      2.22|▇▇▂▅▂ |\n|lon2_pos      |    -1.59|     2.21|   -4.66|   -3.22|   -1.47|    -0.47|      2.72|▇▂▇▅▂ |\n:::\n\n```{.r .cell-code}\n# glimpse(dataKline$df)\n```\n:::\n\n\nand we will also use a matrix of the longitudinal and latitudinal relative\npositions of the societies. This is an approximation only as it used the\nkm per degree at the equator which is 111.32 km per degree at the equator.\nThis gives the following relative position matrix.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(islandsDistMatrix)\ndataKline <- within(dataKline, {\n  dist <- islandsDistMatrix\n  # create the edges dataframe\n  edges_df <- dist\n  # set lower triangle and diagonal to 0 to avoid double values.\n  # zeros can be removed later\n  edges_df[lower.tri(edges_df, diag = FALSE)] <- NA_real_\n  \n  # The distances in dataframe format\n  edges_df <- dist |>\n    as.data.frame() |>\n    tibble::rownames_to_column(var = \"x\") |>\n    pivot_longer(cols = -x, names_to = \"y\", values_to = \"dist\")\n  })\nrm(islandsDistMatrix)\n```\n:::\n\n\n\nand we can visualize the distance in a heatmap\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nheatmaply::heatmaply(\n  x = dataKline$dist,\n  cellnote = round(dataKline$dist, 1),\n  colors = unclass(paletteer::paletteer_c(\"pals::ocean.speed\", n = 16)),\n  hide_colorbar = TRUE,\n  main = \"Distances between Oceanic Societies in Thousands of km\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-337c8444eb7a14a88827\" style=\"width:100%;height:464px;\" class=\"plotly html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-337c8444eb7a14a88827\">{\"x\":{\"data\":[{\"x\":[3.6875,1,null,1,1,null,3.6875,6.375,null,6.375,6.375,null,6.375,3.625,null,3.625,3.625,null,3.625,2.5,null,2.5,2.5,null,2.5,2,null,2,2,null,2.5,3,null,3,3,null,3.625,4.75,null,4.75,4.75,null,4.75,4,null,4,4,null,4.75,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.375,9.125,null,9.125,9.125,null,9.125,8.25,null,8.25,8.25,null,8.25,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8,null,8.25,9,null,9,9,null,9.125,10,null,10,10],\"y\":[14.2425280059405,14.2425280059405,null,14.2425280059405,0,null,14.2425280059405,14.2425280059405,null,14.2425280059405,11.6825717631008,null,11.6825717631008,11.6825717631008,null,11.6825717631008,5.94227220850745,null,5.94227220850745,5.94227220850745,null,5.94227220850745,2.1783264218202,null,2.1783264218202,2.1783264218202,null,2.1783264218202,0,null,2.1783264218202,2.1783264218202,null,2.1783264218202,0,null,5.94227220850745,5.94227220850745,null,5.94227220850745,1.44069844172887,null,1.44069844172887,1.44069844172887,null,1.44069844172887,0,null,1.44069844172887,1.44069844172887,null,1.44069844172887,0.896669392808743,null,0.896669392808743,0.896669392808743,null,0.896669392808743,0,null,0.896669392808743,0.896669392808743,null,0.896669392808743,0,null,11.6825717631008,11.6825717631008,null,11.6825717631008,6.12598596145959,null,6.12598596145959,6.12598596145959,null,6.12598596145959,3.53308929974888,null,3.53308929974888,3.53308929974888,null,3.53308929974888,2.22456018124932,null,2.22456018124932,2.22456018124932,null,2.22456018124932,0,null,2.22456018124932,2.22456018124932,null,2.22456018124932,0,null,3.53308929974888,3.53308929974888,null,3.53308929974888,0,null,6.12598596145959,6.12598596145959,null,6.12598596145959,0],\"text\":[\"y: 14.2425280\",\"y: 14.2425280\",null,\"y: 14.2425280\",\"y: 14.2425280\",null,\"y: 14.2425280\",\"y: 14.2425280\",null,\"y: 14.2425280\",\"y: 14.2425280\",null,\"y: 11.6825718\",\"y: 11.6825718\",null,\"y: 11.6825718\",\"y: 11.6825718\",null,\"y:  5.9422722\",\"y:  5.9422722\",null,\"y:  5.9422722\",\"y:  5.9422722\",null,\"y:  2.1783264\",\"y:  2.1783264\",null,\"y:  2.1783264\",\"y:  2.1783264\",null,\"y:  2.1783264\",\"y:  2.1783264\",null,\"y:  2.1783264\",\"y:  2.1783264\",null,\"y:  5.9422722\",\"y:  5.9422722\",null,\"y:  5.9422722\",\"y:  5.9422722\",null,\"y:  1.4406984\",\"y:  1.4406984\",null,\"y:  1.4406984\",\"y:  1.4406984\",null,\"y:  1.4406984\",\"y:  1.4406984\",null,\"y:  1.4406984\",\"y:  1.4406984\",null,\"y:  0.8966694\",\"y:  0.8966694\",null,\"y:  0.8966694\",\"y:  0.8966694\",null,\"y:  0.8966694\",\"y:  0.8966694\",null,\"y:  0.8966694\",\"y:  0.8966694\",null,\"y: 11.6825718\",\"y: 11.6825718\",null,\"y: 11.6825718\",\"y: 11.6825718\",null,\"y:  6.1259860\",\"y:  6.1259860\",null,\"y:  6.1259860\",\"y:  6.1259860\",null,\"y:  3.5330893\",\"y:  3.5330893\",null,\"y:  3.5330893\",\"y:  3.5330893\",null,\"y:  2.2245602\",\"y:  2.2245602\",null,\"y:  2.2245602\",\"y:  2.2245602\",null,\"y:  2.2245602\",\"y:  2.2245602\",null,\"y:  2.2245602\",\"y:  2.2245602\",null,\"y:  3.5330893\",\"y:  3.5330893\",null,\"y:  3.5330893\",\"y:  3.5330893\",null,\"y:  6.1259860\",\"y:  6.1259860\",null,\"y:  6.1259860\",\"y:  6.1259860\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.26771653543307,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[3.6875,1,6.375,3.625,2.5,2,3,4.75,4,5.5,5,6,9.125,8.25,7.5,7,8,9,10],\"y\":[14.2425280059405,0,11.6825717631008,5.94227220850745,2.1783264218202,0,0,1.44069844172887,0,0.896669392808743,0,0,6.12598596145959,3.53308929974888,2.22456018124932,0,0,0,0],\"text\":[\"y: 14.2425280\",\"y:  0.0000000\",\"y: 11.6825718\",\"y:  5.9422722\",\"y:  2.1783264\",\"y:  0.0000000\",\"y:  0.0000000\",\"y:  1.4406984\",\"y:  0.0000000\",\"y:  0.8966694\",\"y:  0.0000000\",\"y:  0.0000000\",\"y:  6.1259860\",\"y:  3.5330893\",\"y:  2.2245602\",\"y:  0.0000000\",\"y:  0.0000000\",\"y:  0.0000000\",\"y:  0.0000000\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"transparent\",\"opacity\":1,\"size\":null,\"symbol\":null,\"line\":{\"width\":1.88976377952756,\"color\":\"transparent\"}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(44,160,44,1)\",\"line\":{\"color\":\"rgba(44,160,44,1)\"}},\"error_y\":{\"color\":\"rgba(44,160,44,1)\"},\"error_x\":{\"color\":\"rgba(44,160,44,1)\"},\"line\":{\"color\":\"rgba(44,160,44,1)\"},\"xaxis\":\"x2\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[1,2,3,4,5,6,7,8,9,10],\"y\":[1,2,3,4,5,6,7,8,9,10],\"z\":[[0,0.701727500696573,0.680412371134021,0.791028141543605,0.735998885483422,0.752438005015325,0.926859849540262,0.936472555029256,0.80621342992477,1],[0.701727500696573,0,0.106297018668153,0.259125104485929,0.273753134577877,0.317497910281415,0.542351629980496,0.643911953190304,0.667177486765116,0.854834215658958],[0.680412371134021,0.106297018668153,0,0.171914182223461,0.172192811368069,0.215937587071608,0.448453608247423,0.544162719420451,0.561019782669267,0.751044859292282],[0.791028141543605,0.259125104485929,0.171914182223461,0,0.0661744218445249,0.08790749512399,0.28364446921148,0.389244915018111,0.442741710782948,0.6078294789635],[0.735998885483422,0.273753134577877,0.172192811368069,0.0661744218445249,0,0.0438840902758429,0.279604346614656,0.371969908052382,0.400808024519365,0.58135971022569],[0.752438005015325,0.317497910281415,0.215937587071608,0.08790749512399,0.0438840902758429,0,0.237949289495681,0.328225132348844,0.360546113123433,0.537614934522151],[0.926859849540262,0.542351629980496,0.448453608247423,0.28364446921148,0.279604346614656,0.237949289495681,0,0.118417386458624,0.250905544719978,0.342992477013096],[0.936472555029256,0.643911953190304,0.544162719420451,0.389244915018111,0.371969908052382,0.328225132348844,0.118417386458624,0,0.168988576205071,0.225132348843689],[0.80621342992477,0.667177486765116,0.561019782669267,0.442741710782948,0.400808024519365,0.360546113123433,0.250905544719978,0.168988576205071,0,0.216634159933129],[1,0.854834215658958,0.751044859292282,0.6078294789635,0.58135971022569,0.537614934522151,0.342992477013096,0.225132348843689,0.216634159933129,0]],\"text\":[[\"row: Hawaii<br>column: Hawaii<br>value: 0.000\",\"row: Hawaii<br>column: Tonga<br>value: 5.037\",\"row: Hawaii<br>column: Lau Fiji<br>value: 4.884\",\"row: Hawaii<br>column: Malekula<br>value: 5.678\",\"row: Hawaii<br>column: Tikopia<br>value: 5.283\",\"row: Hawaii<br>column: Santa Cruz<br>value: 5.401\",\"row: Hawaii<br>column: Trobriand<br>value: 6.653\",\"row: Hawaii<br>column: Manus<br>value: 6.722\",\"row: Hawaii<br>column: Chuuk<br>value: 5.787\",\"row: Hawaii<br>column: Yap<br>value: 7.178\"],[\"row: Tonga<br>column: Hawaii<br>value: 5.037\",\"row: Tonga<br>column: Tonga<br>value: 0.000\",\"row: Tonga<br>column: Lau Fiji<br>value: 0.763\",\"row: Tonga<br>column: Malekula<br>value: 1.860\",\"row: Tonga<br>column: Tikopia<br>value: 1.965\",\"row: Tonga<br>column: Santa Cruz<br>value: 2.279\",\"row: Tonga<br>column: Trobriand<br>value: 3.893\",\"row: Tonga<br>column: Manus<br>value: 4.622\",\"row: Tonga<br>column: Chuuk<br>value: 4.789\",\"row: Tonga<br>column: Yap<br>value: 6.136\"],[\"row: Lau Fiji<br>column: Hawaii<br>value: 4.884\",\"row: Lau Fiji<br>column: Tonga<br>value: 0.763\",\"row: Lau Fiji<br>column: Lau Fiji<br>value: 0.000\",\"row: Lau Fiji<br>column: Malekula<br>value: 1.234\",\"row: Lau Fiji<br>column: Tikopia<br>value: 1.236\",\"row: Lau Fiji<br>column: Santa Cruz<br>value: 1.550\",\"row: Lau Fiji<br>column: Trobriand<br>value: 3.219\",\"row: Lau Fiji<br>column: Manus<br>value: 3.906\",\"row: Lau Fiji<br>column: Chuuk<br>value: 4.027\",\"row: Lau Fiji<br>column: Yap<br>value: 5.391\"],[\"row: Malekula<br>column: Hawaii<br>value: 5.678\",\"row: Malekula<br>column: Tonga<br>value: 1.860\",\"row: Malekula<br>column: Lau Fiji<br>value: 1.234\",\"row: Malekula<br>column: Malekula<br>value: 0.000\",\"row: Malekula<br>column: Tikopia<br>value: 0.475\",\"row: Malekula<br>column: Santa Cruz<br>value: 0.631\",\"row: Malekula<br>column: Trobriand<br>value: 2.036\",\"row: Malekula<br>column: Manus<br>value: 2.794\",\"row: Malekula<br>column: Chuuk<br>value: 3.178\",\"row: Malekula<br>column: Yap<br>value: 4.363\"],[\"row: Tikopia<br>column: Hawaii<br>value: 5.283\",\"row: Tikopia<br>column: Tonga<br>value: 1.965\",\"row: Tikopia<br>column: Lau Fiji<br>value: 1.236\",\"row: Tikopia<br>column: Malekula<br>value: 0.475\",\"row: Tikopia<br>column: Tikopia<br>value: 0.000\",\"row: Tikopia<br>column: Santa Cruz<br>value: 0.315\",\"row: Tikopia<br>column: Trobriand<br>value: 2.007\",\"row: Tikopia<br>column: Manus<br>value: 2.670\",\"row: Tikopia<br>column: Chuuk<br>value: 2.877\",\"row: Tikopia<br>column: Yap<br>value: 4.173\"],[\"row: Santa Cruz<br>column: Hawaii<br>value: 5.401\",\"row: Santa Cruz<br>column: Tonga<br>value: 2.279\",\"row: Santa Cruz<br>column: Lau Fiji<br>value: 1.550\",\"row: Santa Cruz<br>column: Malekula<br>value: 0.631\",\"row: Santa Cruz<br>column: Tikopia<br>value: 0.315\",\"row: Santa Cruz<br>column: Santa Cruz<br>value: 0.000\",\"row: Santa Cruz<br>column: Trobriand<br>value: 1.708\",\"row: Santa Cruz<br>column: Manus<br>value: 2.356\",\"row: Santa Cruz<br>column: Chuuk<br>value: 2.588\",\"row: Santa Cruz<br>column: Yap<br>value: 3.859\"],[\"row: Trobriand<br>column: Hawaii<br>value: 6.653\",\"row: Trobriand<br>column: Tonga<br>value: 3.893\",\"row: Trobriand<br>column: Lau Fiji<br>value: 3.219\",\"row: Trobriand<br>column: Malekula<br>value: 2.036\",\"row: Trobriand<br>column: Tikopia<br>value: 2.007\",\"row: Trobriand<br>column: Santa Cruz<br>value: 1.708\",\"row: Trobriand<br>column: Trobriand<br>value: 0.000\",\"row: Trobriand<br>column: Manus<br>value: 0.850\",\"row: Trobriand<br>column: Chuuk<br>value: 1.801\",\"row: Trobriand<br>column: Yap<br>value: 2.462\"],[\"row: Manus<br>column: Hawaii<br>value: 6.722\",\"row: Manus<br>column: Tonga<br>value: 4.622\",\"row: Manus<br>column: Lau Fiji<br>value: 3.906\",\"row: Manus<br>column: Malekula<br>value: 2.794\",\"row: Manus<br>column: Tikopia<br>value: 2.670\",\"row: Manus<br>column: Santa Cruz<br>value: 2.356\",\"row: Manus<br>column: Trobriand<br>value: 0.850\",\"row: Manus<br>column: Manus<br>value: 0.000\",\"row: Manus<br>column: Chuuk<br>value: 1.213\",\"row: Manus<br>column: Yap<br>value: 1.616\"],[\"row: Chuuk<br>column: Hawaii<br>value: 5.787\",\"row: Chuuk<br>column: Tonga<br>value: 4.789\",\"row: Chuuk<br>column: Lau Fiji<br>value: 4.027\",\"row: Chuuk<br>column: Malekula<br>value: 3.178\",\"row: Chuuk<br>column: Tikopia<br>value: 2.877\",\"row: Chuuk<br>column: Santa Cruz<br>value: 2.588\",\"row: Chuuk<br>column: Trobriand<br>value: 1.801\",\"row: Chuuk<br>column: Manus<br>value: 1.213\",\"row: Chuuk<br>column: Chuuk<br>value: 0.000\",\"row: Chuuk<br>column: Yap<br>value: 1.555\"],[\"row: Yap<br>column: Hawaii<br>value: 7.178\",\"row: Yap<br>column: Tonga<br>value: 6.136\",\"row: Yap<br>column: Lau Fiji<br>value: 5.391\",\"row: Yap<br>column: Malekula<br>value: 4.363\",\"row: Yap<br>column: Tikopia<br>value: 4.173\",\"row: Yap<br>column: Santa Cruz<br>value: 3.859\",\"row: Yap<br>column: Trobriand<br>value: 2.462\",\"row: Yap<br>column: Manus<br>value: 1.616\",\"row: Yap<br>column: Chuuk<br>value: 1.555\",\"row: Yap<br>column: Yap<br>value: 0.000\"]],\"colorscale\":[[0,\"#FFFDCD\"],[0.0438840902758429,\"#F7F0B5\"],[0.0661744218445249,\"#F3E9A8\"],[0.08790749512399,\"#EFE39D\"],[0.106297018668153,\"#EBDE93\"],[0.118417386458624,\"#E9DA8C\"],[0.168988576205071,\"#DDCD71\"],[0.171914182223461,\"#DCCC6F\"],[0.172192811368069,\"#DCCC6F\"],[0.215937587071608,\"#D0C258\"],[0.216634159933129,\"#D0C158\"],[0.225132348843689,\"#CEC054\"],[0.237949289495681,\"#CABD4D\"],[0.250905544719978,\"#C7BA46\"],[0.259125104485929,\"#C4B942\"],[0.273753134577877,\"#BFB63B\"],[0.279604346614656,\"#BDB539\"],[0.28364446921148,\"#BBB438\"],[0.317497910281415,\"#AEAF2A\"],[0.328225132348844,\"#AAAD25\"],[0.342992477013096,\"#A4AA21\"],[0.360546113123433,\"#9DA81C\"],[0.371969908052382,\"#98A619\"],[0.389244915018111,\"#91A314\"],[0.400808024519365,\"#8CA110\"],[0.442741710782948,\"#799B0D\"],[0.448453608247423,\"#769A0D\"],[0.537614934522151,\"#4E8A12\"],[0.542351629980496,\"#4C8913\"],[0.544162719420451,\"#4C8914\"],[0.561019782669267,\"#448617\"],[0.58135971022569,\"#3B821B\"],[0.6078294789635,\"#307D1F\"],[0.643911953190304,\"#257624\"],[0.667177486765116,\"#1D7126\"],[0.680412371134021,\"#1A6E27\"],[0.701727500696573,\"#166929\"],[0.735998885483422,\"#0E612B\"],[0.751044859292282,\"#0F5E2B\"],[0.752438005015325,\"#0F5D2B\"],[0.791028141543605,\"#0F542A\"],[0.80621342992477,\"#10502A\"],[0.854834215658958,\"#154527\"],[0.926859849540262,\"#17341E\"],[0.936472555029256,\"#17311D\"],[1,\"#172313\"]],\"type\":\"heatmap\",\"showscale\":false,\"autocolorscale\":false,\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1],\"y\":[1],\"name\":\"99_f7a4d3af9dd6cd69e8086a45521b54cc\",\"type\":\"scatter\",\"mode\":\"markers\",\"opacity\":0,\"hoverinfo\":\"skip\",\"showlegend\":false,\"marker\":{\"color\":[0,1],\"colorscale\":[[0,\"#FFFDCD\"],[0.00334448160535117,\"#FEFCCB\"],[0.00668896321070234,\"#FEFBC9\"],[0.0100334448160535,\"#FDFAC7\"],[0.0133779264214047,\"#FDF9C6\"],[0.0167224080267559,\"#FCF8C4\"],[0.020066889632107,\"#FCF7C2\"],[0.0234113712374582,\"#FBF6C0\"],[0.0267558528428094,\"#FAF5BE\"],[0.0301003344481605,\"#FAF4BC\"],[0.0334448160535117,\"#F9F3BA\"],[0.0367892976588629,\"#F9F2B9\"],[0.040133779264214,\"#F8F1B7\"],[0.0434782608695652,\"#F7F0B5\"],[0.0468227424749164,\"#F7EFB3\"],[0.0501672240802676,\"#F6EEB1\"],[0.0535117056856187,\"#F5EDAF\"],[0.0568561872909699,\"#F5ECAD\"],[0.0602006688963211,\"#F4EBAC\"],[0.0635451505016722,\"#F4EAAA\"],[0.0668896321070234,\"#F3E9A8\"],[0.0702341137123746,\"#F2E8A6\"],[0.0735785953177257,\"#F2E7A4\"],[0.0769230769230769,\"#F1E6A2\"],[0.0802675585284281,\"#F0E5A1\"],[0.0836120401337793,\"#F0E49F\"],[0.0869565217391304,\"#EFE39D\"],[0.0903010033444816,\"#EFE29B\"],[0.0936454849498328,\"#EEE199\"],[0.0969899665551839,\"#EDE098\"],[0.100334448160535,\"#EDDF96\"],[0.103678929765886,\"#ECDE94\"],[0.107023411371237,\"#EBDD92\"],[0.110367892976589,\"#EBDD90\"],[0.11371237458194,\"#EADC8F\"],[0.117056856187291,\"#E9DB8D\"],[0.120401337792642,\"#E9DA8B\"],[0.123745819397993,\"#E8D989\"],[0.127090301003344,\"#E7D887\"],[0.130434782608696,\"#E7D786\"],[0.133779264214047,\"#E6D684\"],[0.137123745819398,\"#E5D582\"],[0.140468227424749,\"#E4D480\"],[0.1438127090301,\"#E3D37E\"],[0.147157190635451,\"#E3D27D\"],[0.150501672240803,\"#E2D27B\"],[0.153846153846154,\"#E1D179\"],[0.157190635451505,\"#E0D077\"],[0.160535117056856,\"#DFCF75\"],[0.163879598662207,\"#DECE74\"],[0.167224080267559,\"#DDCD72\"],[0.17056856187291,\"#DDCC70\"],[0.173913043478261,\"#DCCC6E\"],[0.177257525083612,\"#DBCB6C\"],[0.180602006688963,\"#DACA6B\"],[0.183946488294314,\"#D9C969\"],[0.187290969899666,\"#D8C867\"],[0.190635451505017,\"#D7C765\"],[0.193979933110368,\"#D7C763\"],[0.197324414715719,\"#D6C661\"],[0.20066889632107,\"#D5C560\"],[0.204013377926421,\"#D4C45E\"],[0.207357859531773,\"#D3C35C\"],[0.210702341137124,\"#D2C35B\"],[0.214046822742475,\"#D1C259\"],[0.217391304347826,\"#D0C157\"],[0.220735785953177,\"#CFC156\"],[0.224080267558528,\"#CEC054\"],[0.22742474916388,\"#CDBF52\"],[0.230769230769231,\"#CCBF51\"],[0.234113712374582,\"#CBBE4F\"],[0.237458193979933,\"#CABD4D\"],[0.240802675585284,\"#C9BC4C\"],[0.244147157190635,\"#C8BC4A\"],[0.247491638795987,\"#C8BB48\"],[0.250836120401338,\"#C7BA46\"],[0.254180602006689,\"#C6BA45\"],[0.25752508361204,\"#C5B943\"],[0.260869565217391,\"#C4B841\"],[0.264214046822742,\"#C3B83F\"],[0.267558528428094,\"#C2B73E\"],[0.270903010033445,\"#C0B63C\"],[0.274247491638796,\"#BFB63B\"],[0.277591973244147,\"#BEB53A\"],[0.280936454849498,\"#BCB539\"],[0.284280936454849,\"#BBB437\"],[0.287625418060201,\"#BAB436\"],[0.290969899665552,\"#B9B335\"],[0.294314381270903,\"#B7B234\"],[0.297658862876254,\"#B6B232\"],[0.301003344481605,\"#B5B131\"],[0.304347826086956,\"#B3B130\"],[0.307692307692308,\"#B2B02E\"],[0.311036789297659,\"#B1B02D\"],[0.31438127090301,\"#AFAF2B\"],[0.317725752508361,\"#AEAF2A\"],[0.321070234113712,\"#ADAE29\"],[0.324414715719064,\"#ABAD27\"],[0.327759197324415,\"#AAAD26\"],[0.331103678929766,\"#A9AC24\"],[0.334448160535117,\"#A8AC23\"],[0.337792642140468,\"#A6AB22\"],[0.341137123745819,\"#A5AB21\"],[0.344481605351171,\"#A3AA20\"],[0.347826086956522,\"#A2AA1F\"],[0.351170568561873,\"#A1A91F\"],[0.354515050167224,\"#9FA91E\"],[0.357859531772575,\"#9EA81D\"],[0.361204013377926,\"#9CA71C\"],[0.364548494983278,\"#9BA71B\"],[0.367892976588629,\"#9AA61A\"],[0.37123745819398,\"#98A619\"],[0.374581939799331,\"#97A518\"],[0.377926421404682,\"#95A517\"],[0.381270903010033,\"#94A416\"],[0.384615384615385,\"#92A415\"],[0.387959866220736,\"#91A314\"],[0.391304347826087,\"#90A213\"],[0.394648829431438,\"#8EA212\"],[0.397993311036789,\"#8DA111\"],[0.40133779264214,\"#8BA110\"],[0.404682274247492,\"#8AA010\"],[0.408026755852843,\"#88A010\"],[0.411371237458194,\"#879F0F\"],[0.414715719063545,\"#859F0F\"],[0.418060200668896,\"#849E0F\"],[0.421404682274247,\"#839E0F\"],[0.424749163879599,\"#819D0E\"],[0.42809364548495,\"#809D0E\"],[0.431438127090301,\"#7E9C0E\"],[0.434782608695652,\"#7D9C0E\"],[0.438127090301003,\"#7B9B0E\"],[0.441471571906354,\"#7A9B0D\"],[0.444816053511706,\"#789A0D\"],[0.448160535117057,\"#769A0D\"],[0.451505016722408,\"#75990D\"],[0.454849498327759,\"#73990D\"],[0.45819397993311,\"#72980C\"],[0.461538461538462,\"#70980C\"],[0.464882943143813,\"#6F970C\"],[0.468227424749164,\"#6D970C\"],[0.471571906354515,\"#6C960C\"],[0.474916387959866,\"#6A960D\"],[0.478260869565217,\"#69950D\"],[0.481605351170569,\"#67940D\"],[0.48494983277592,\"#66940E\"],[0.488294314381271,\"#65930E\"],[0.491638795986622,\"#63930E\"],[0.494983277591973,\"#62920E\"],[0.498327759197324,\"#60910F\"],[0.501672240802676,\"#5F910F\"],[0.505016722408027,\"#5D900F\"],[0.508361204013378,\"#5C900F\"],[0.511705685618729,\"#5A8F10\"],[0.51505016722408,\"#598E10\"],[0.518394648829431,\"#578E10\"],[0.521739130434783,\"#558D10\"],[0.525083612040134,\"#548C11\"],[0.528428093645485,\"#528C11\"],[0.531772575250836,\"#518B11\"],[0.535117056856187,\"#4F8B11\"],[0.538461538461538,\"#4E8A12\"],[0.54180602006689,\"#4D8913\"],[0.545150501672241,\"#4B8914\"],[0.548494983277592,\"#4A8815\"],[0.551839464882943,\"#488815\"],[0.555183946488294,\"#478716\"],[0.558528428093645,\"#458617\"],[0.561872909698997,\"#448618\"],[0.565217391304348,\"#438518\"],[0.568561872909699,\"#418519\"],[0.57190635451505,\"#408419\"],[0.575250836120401,\"#3E831A\"],[0.578595317725752,\"#3C831B\"],[0.581939799331104,\"#3B821B\"],[0.585284280936455,\"#39821C\"],[0.588628762541806,\"#38811C\"],[0.591973244147157,\"#36801D\"],[0.595317725752508,\"#34801D\"],[0.598662207357859,\"#337F1E\"],[0.602006688963211,\"#317F1E\"],[0.605351170568562,\"#307E1F\"],[0.608695652173913,\"#307D1F\"],[0.612040133779264,\"#2F7C20\"],[0.615384615384615,\"#2E7C20\"],[0.618729096989967,\"#2D7B21\"],[0.622073578595318,\"#2C7A21\"],[0.625418060200669,\"#2B7A21\"],[0.62876254180602,\"#2A7922\"],[0.632107023411371,\"#297822\"],[0.635451505016722,\"#287823\"],[0.638795986622073,\"#277723\"],[0.642140468227425,\"#257623\"],[0.645484949832776,\"#247524\"],[0.648829431438127,\"#237524\"],[0.652173913043478,\"#227425\"],[0.655518394648829,\"#217325\"],[0.65886287625418,\"#207325\"],[0.662207357859532,\"#1F7226\"],[0.665551839464883,\"#1D7126\"],[0.668896321070234,\"#1D7026\"],[0.672240802675585,\"#1C7026\"],[0.675585284280936,\"#1B6F27\"],[0.678929765886288,\"#1B6E27\"],[0.682274247491639,\"#1A6D27\"],[0.68561872909699,\"#196D28\"],[0.688963210702341,\"#196C28\"],[0.692307692307692,\"#186B28\"],[0.695652173913043,\"#176A28\"],[0.698996655518395,\"#166A29\"],[0.702341137123746,\"#166929\"],[0.705685618729097,\"#156829\"],[0.709030100334448,\"#146729\"],[0.712374581939799,\"#13672A\"],[0.71571906354515,\"#13662A\"],[0.719063545150502,\"#12652A\"],[0.722408026755853,\"#11642A\"],[0.725752508361204,\"#10642B\"],[0.729096989966555,\"#0F632B\"],[0.732441471571906,\"#0E622B\"],[0.735785953177257,\"#0E612B\"],[0.739130434782609,\"#0E612B\"],[0.74247491638796,\"#0E602B\"],[0.745819397993311,\"#0E5F2B\"],[0.749163879598662,\"#0E5E2B\"],[0.752508361204013,\"#0F5D2B\"],[0.755852842809364,\"#0F5D2B\"],[0.759197324414716,\"#0F5C2B\"],[0.762541806020067,\"#0F5B2B\"],[0.765886287625418,\"#0F5A2B\"],[0.769230769230769,\"#0F592B\"],[0.77257525083612,\"#0F592A\"],[0.775919732441471,\"#0F582A\"],[0.779264214046823,\"#0F572A\"],[0.782608695652174,\"#0F562A\"],[0.785953177257525,\"#0F552A\"],[0.789297658862876,\"#0F552A\"],[0.792642140468227,\"#0F542A\"],[0.795986622073579,\"#0F532A\"],[0.79933110367893,\"#0F522A\"],[0.802675585284281,\"#0F512A\"],[0.806020066889632,\"#10512A\"],[0.809364548494983,\"#105029\"],[0.812709030100334,\"#114F29\"],[0.816053511705686,\"#114E29\"],[0.819397993311037,\"#124D29\"],[0.822742474916388,\"#124C29\"],[0.826086956521739,\"#134C28\"],[0.82943143812709,\"#134B28\"],[0.832775919732441,\"#134A28\"],[0.836120401337793,\"#144928\"],[0.839464882943144,\"#144828\"],[0.842809364548495,\"#144827\"],[0.846153846153846,\"#154727\"],[0.849498327759197,\"#154627\"],[0.852842809364548,\"#154527\"],[0.8561872909699,\"#154427\"],[0.859531772575251,\"#164426\"],[0.862876254180602,\"#164326\"],[0.866220735785953,\"#164226\"],[0.869565217391304,\"#164126\"],[0.872909698996655,\"#164025\"],[0.876254180602007,\"#164025\"],[0.879598662207358,\"#163F24\"],[0.882943143812709,\"#173E24\"],[0.88628762541806,\"#173D23\"],[0.889632107023411,\"#173C23\"],[0.892976588628763,\"#173C22\"],[0.896321070234114,\"#173B22\"],[0.899665551839465,\"#173A22\"],[0.903010033444816,\"#173921\"],[0.906354515050167,\"#173821\"],[0.909698996655518,\"#173820\"],[0.91304347826087,\"#173720\"],[0.916387959866221,\"#17361F\"],[0.919732441471572,\"#17351F\"],[0.923076923076923,\"#17341E\"],[0.926421404682274,\"#17341E\"],[0.929765886287625,\"#17331D\"],[0.933110367892977,\"#17321D\"],[0.936454849498328,\"#17311D\"],[0.939799331103679,\"#17311C\"],[0.94314381270903,\"#17301C\"],[0.946488294314381,\"#172F1B\"],[0.949832775919732,\"#172E1B\"],[0.953177257525084,\"#172D1A\"],[0.956521739130435,\"#172D1A\"],[0.959866220735786,\"#172C19\"],[0.963210702341137,\"#172B19\"],[0.966555183946488,\"#172A18\"],[0.969899665551839,\"#172A18\"],[0.973244147157191,\"#172917\"],[0.976588628762542,\"#172817\"],[0.979933110367893,\"#172716\"],[0.983277591973244,\"#172716\"],[0.986622073578595,\"#172615\"],[0.989966555183946,\"#172515\"],[0.993311036789298,\"#172414\"],[0.996655518394649,\"#172414\"],[1,\"#172313\"]],\"colorbar\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"thickness\":23.04,\"title\":null,\"titlefont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187},\"tickmode\":\"array\",\"ticktext\":[\"0\",\"2\",\"4\",\"6\"],\"tickvals\":[0,0.278629144608526,0.557258289217052,0.835887433825578],\"tickfont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.689497716895},\"ticklen\":2,\"len\":0.5},\"showscale\":false},\"xaxis\":\"x\",\"yaxis\":\"y2\",\"frame\":null},{\"x\":[1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10],\"y\":[1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10],\"text\":[\"0\",\"5\",\"4.9\",\"5.7\",\"5.3\",\"5.4\",\"6.7\",\"6.7\",\"5.8\",\"7.2\",\"5\",\"0\",\"0.8\",\"1.9\",\"2\",\"2.3\",\"3.9\",\"4.6\",\"4.8\",\"6.1\",\"4.9\",\"0.8\",\"0\",\"1.2\",\"1.2\",\"1.6\",\"3.2\",\"3.9\",\"4\",\"5.4\",\"5.7\",\"1.9\",\"1.2\",\"0\",\"0.5\",\"0.6\",\"2\",\"2.8\",\"3.2\",\"4.4\",\"5.3\",\"2\",\"1.2\",\"0.5\",\"0\",\"0.3\",\"2\",\"2.7\",\"2.9\",\"4.2\",\"5.4\",\"2.3\",\"1.6\",\"0.6\",\"0.3\",\"0\",\"1.7\",\"2.4\",\"2.6\",\"3.9\",\"6.7\",\"3.9\",\"3.2\",\"2\",\"2\",\"1.7\",\"0\",\"0.8\",\"1.8\",\"2.5\",\"6.7\",\"4.6\",\"3.9\",\"2.8\",\"2.7\",\"2.4\",\"0.8\",\"0\",\"1.2\",\"1.6\",\"5.8\",\"4.8\",\"4\",\"3.2\",\"2.9\",\"2.6\",\"1.8\",\"1.2\",\"0\",\"1.6\",\"7.2\",\"6.1\",\"5.4\",\"4.4\",\"4.2\",\"3.9\",\"2.5\",\"1.6\",\"1.6\",\"0\"],\"customdata\":[0,5.037,4.884,5.678,5.283,5.401,6.653,6.722,5.787,7.178,5.037,0,0.763,1.86,1.965,2.279,3.893,4.622,4.789,6.136,4.884,0.763,0,1.234,1.236,1.55,3.219,3.906,4.027,5.391,5.678,1.86,1.234,0,0.475,0.631,2.036,2.794,3.178,4.363,5.283,1.965,1.236,0.475,0,0.315,2.007,2.67,2.877,4.173,5.401,2.279,1.55,0.631,0.315,0,1.708,2.356,2.588,3.859,6.653,3.893,3.219,2.036,2.007,1.708,0,0.85,1.801,2.462,6.722,4.622,3.906,2.794,2.67,2.356,0.85,0,1.213,1.616,5.787,4.789,4.027,3.178,2.877,2.588,1.801,1.213,0,1.555,7.178,6.136,5.391,4.363,4.173,3.859,2.462,1.616,1.555,0],\"type\":\"scatter\",\"mode\":\"text\",\"textposition\":[\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\"],\"hovertemplate\":[\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\"],\"showlegend\":false,\"textfont\":{\"color\":[\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\"],\"size\":12},\"marker\":{\"color\":\"rgba(140,86,75,1)\",\"line\":{\"color\":\"rgba(140,86,75,1)\"},\"showscale\":false},\"error_y\":{\"color\":\"rgba(140,86,75,1)\"},\"error_x\":{\"color\":\"rgba(140,86,75,1)\"},\"line\":{\"color\":\"rgba(140,86,75,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y2\",\"frame\":null},{\"x\":[14.2425280059405,14.2425280059405,null,14.2425280059405,0,null,14.2425280059405,14.2425280059405,null,14.2425280059405,11.6825717631008,null,11.6825717631008,11.6825717631008,null,11.6825717631008,5.94227220850745,null,5.94227220850745,5.94227220850745,null,5.94227220850745,2.1783264218202,null,2.1783264218202,2.1783264218202,null,2.1783264218202,0,null,2.1783264218202,2.1783264218202,null,2.1783264218202,0,null,5.94227220850745,5.94227220850745,null,5.94227220850745,1.44069844172887,null,1.44069844172887,1.44069844172887,null,1.44069844172887,0,null,1.44069844172887,1.44069844172887,null,1.44069844172887,0.896669392808743,null,0.896669392808743,0.896669392808743,null,0.896669392808743,0,null,0.896669392808743,0.896669392808743,null,0.896669392808743,0,null,11.6825717631008,11.6825717631008,null,11.6825717631008,6.12598596145959,null,6.12598596145959,6.12598596145959,null,6.12598596145959,3.53308929974888,null,3.53308929974888,3.53308929974888,null,3.53308929974888,2.22456018124932,null,2.22456018124932,2.22456018124932,null,2.22456018124932,0,null,2.22456018124932,2.22456018124932,null,2.22456018124932,0,null,3.53308929974888,3.53308929974888,null,3.53308929974888,0,null,6.12598596145959,6.12598596145959,null,6.12598596145959,0],\"y\":[3.6875,1,null,1,1,null,3.6875,6.375,null,6.375,6.375,null,6.375,3.625,null,3.625,3.625,null,3.625,2.5,null,2.5,2.5,null,2.5,2,null,2,2,null,2.5,3,null,3,3,null,3.625,4.75,null,4.75,4.75,null,4.75,4,null,4,4,null,4.75,5.5,null,5.5,5.5,null,5.5,5,null,5,5,null,5.5,6,null,6,6,null,6.375,9.125,null,9.125,9.125,null,9.125,8.25,null,8.25,8.25,null,8.25,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8,null,8.25,9,null,9,9,null,9.125,10,null,10,10],\"text\":[\"y: 14.2425280\",\"y: 14.2425280\",null,\"y: 14.2425280\",\"y: 14.2425280\",null,\"y: 14.2425280\",\"y: 14.2425280\",null,\"y: 14.2425280\",\"y: 14.2425280\",null,\"y: 11.6825718\",\"y: 11.6825718\",null,\"y: 11.6825718\",\"y: 11.6825718\",null,\"y:  5.9422722\",\"y:  5.9422722\",null,\"y:  5.9422722\",\"y:  5.9422722\",null,\"y:  2.1783264\",\"y:  2.1783264\",null,\"y:  2.1783264\",\"y:  2.1783264\",null,\"y:  2.1783264\",\"y:  2.1783264\",null,\"y:  2.1783264\",\"y:  2.1783264\",null,\"y:  5.9422722\",\"y:  5.9422722\",null,\"y:  5.9422722\",\"y:  5.9422722\",null,\"y:  1.4406984\",\"y:  1.4406984\",null,\"y:  1.4406984\",\"y:  1.4406984\",null,\"y:  1.4406984\",\"y:  1.4406984\",null,\"y:  1.4406984\",\"y:  1.4406984\",null,\"y:  0.8966694\",\"y:  0.8966694\",null,\"y:  0.8966694\",\"y:  0.8966694\",null,\"y:  0.8966694\",\"y:  0.8966694\",null,\"y:  0.8966694\",\"y:  0.8966694\",null,\"y: 11.6825718\",\"y: 11.6825718\",null,\"y: 11.6825718\",\"y: 11.6825718\",null,\"y:  6.1259860\",\"y:  6.1259860\",null,\"y:  6.1259860\",\"y:  6.1259860\",null,\"y:  3.5330893\",\"y:  3.5330893\",null,\"y:  3.5330893\",\"y:  3.5330893\",null,\"y:  2.2245602\",\"y:  2.2245602\",null,\"y:  2.2245602\",\"y:  2.2245602\",null,\"y:  2.2245602\",\"y:  2.2245602\",null,\"y:  2.2245602\",\"y:  2.2245602\",null,\"y:  3.5330893\",\"y:  3.5330893\",null,\"y:  3.5330893\",\"y:  3.5330893\",null,\"y:  6.1259860\",\"y:  6.1259860\",null,\"y:  6.1259860\",\"y:  6.1259860\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.26771653543307,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[14.2425280059405,0,11.6825717631008,5.94227220850745,2.1783264218202,0,0,1.44069844172887,0,0.896669392808743,0,0,6.12598596145959,3.53308929974888,2.22456018124932,0,0,0,0],\"y\":[3.6875,1,6.375,3.625,2.5,2,3,4.75,4,5.5,5,6,9.125,8.25,7.5,7,8,9,10],\"text\":[\"y: 14.2425280\",\"y:  0.0000000\",\"y: 11.6825718\",\"y:  5.9422722\",\"y:  2.1783264\",\"y:  0.0000000\",\"y:  0.0000000\",\"y:  1.4406984\",\"y:  0.0000000\",\"y:  0.8966694\",\"y:  0.0000000\",\"y:  0.0000000\",\"y:  6.1259860\",\"y:  3.5330893\",\"y:  2.2245602\",\"y:  0.0000000\",\"y:  0.0000000\",\"y:  0.0000000\",\"y:  0.0000000\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"transparent\",\"opacity\":1,\"size\":null,\"symbol\":null,\"line\":{\"width\":1.88976377952756,\"color\":\"transparent\"}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"xaxis\":{\"domain\":[0,0.8],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.5,10.5],\"tickmode\":\"array\",\"ticktext\":[\"Hawaii\",\"Tonga\",\"Lau Fiji\",\"Malekula\",\"Tikopia\",\"Santa Cruz\",\"Trobriand\",\"Manus\",\"Chuuk\",\"Yap\"],\"tickvals\":[1,2,3,4,5,6,7,8,9,10],\"categoryorder\":\"array\",\"categoryarray\":[\"Hawaii\",\"Tonga\",\"Lau Fiji\",\"Malekula\",\"Tikopia\",\"Santa Cruz\",\"Trobriand\",\"Manus\",\"Chuuk\",\"Yap\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":13.2835201328352},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"xaxis2\":{\"domain\":[0.8,1],\"automargin\":true,\"showticklabels\":false,\"showgrid\":false,\"zeroline\":false,\"anchor\":\"y2\",\"type\":\"linear\",\"autorange\":false,\"range\":[0,14.2425280059405],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"5\",\"10\"],\"tickvals\":[0,5,10],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"5\",\"10\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.65296803652968,\"tickwidth\":0,\"tickfont\":{\"color\":null,\"family\":null,\"size\":0},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"gridcolor\":null,\"gridwidth\":0,\"title\":{\"text\":\"\",\"font\":{\"color\":null,\"family\":null,\"size\":0}},\"hoverformat\":\".2f\"},\"yaxis2\":{\"domain\":[0,0.8],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.5,10.5],\"tickmode\":\"array\",\"ticktext\":[\"Hawaii\",\"Tonga\",\"Lau Fiji\",\"Malekula\",\"Tikopia\",\"Santa Cruz\",\"Trobriand\",\"Manus\",\"Chuuk\",\"Yap\"],\"tickvals\":[1,2,3,4,5,6,7,8,9,10],\"categoryorder\":\"array\",\"categoryarray\":[\"Hawaii\",\"Tonga\",\"Lau Fiji\",\"Malekula\",\"Tikopia\",\"Santa Cruz\",\"Trobriand\",\"Manus\",\"Chuuk\",\"Yap\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":13.2835201328352},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"\",\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0.8,1],\"automargin\":true,\"showticklabels\":false,\"showgrid\":false,\"zeroline\":false,\"anchor\":\"x\",\"type\":\"linear\",\"autorange\":false,\"range\":[0,14.2425280059405],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"5\",\"10\"],\"tickvals\":[0,5,10],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"5\",\"10\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.65296803652968,\"tickwidth\":0,\"tickfont\":{\"color\":null,\"family\":null,\"size\":0},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"gridcolor\":null,\"gridwidth\":0,\"title\":{\"text\":\"\",\"font\":{\"color\":null,\"family\":null,\"size\":0}},\"hoverformat\":\".2f\"},\"annotations\":[],\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.8,\"y0\":0.8,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.8,\"y0\":0,\"y1\":0.8},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.8,\"x1\":1,\"y0\":0,\"y1\":0.8}],\"images\":[],\"margin\":{\"t\":30,\"r\":null,\"b\":79.7011207970112,\"l\":79.7011207970112},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187},\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.689497716895},\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"y\":1,\"yanchor\":\"top\"},\"hovermode\":\"closest\",\"barmode\":\"relative\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"title\":\"Distances between Oceanic Societies in Thousands of km\"},\"attrs\":{\"1b9c717375a3\":{\"xend\":{},\"yend\":{},\"colour\":{},\"linetype\":{},\"size\":{},\"x\":{},\"y\":{},\"type\":\"scatter\"},\"1b9c53b27779\":{\"colour\":{},\"shape\":{},\"size\":{},\"x\":{},\"y\":{}},\"1b9c66c030cb\":{\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20]},\"1b9c5ac13dc6\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"heatmap\"},\"1b9c278f2f2b\":{\"x\":{},\"y\":{},\"text\":{},\"customdata\":{},\"type\":\"scatter\",\"mode\":\"text\",\"textposition\":\"middle right\",\"hovertemplate\":\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"showlegend\":false,\"textfont\":{\"color\":[\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\"],\"size\":12},\"inherit\":false},\"1b9c7e8b6a99\":{\"xend\":{},\"yend\":{},\"colour\":{},\"linetype\":{},\"size\":{},\"x\":{},\"y\":{},\"type\":\"scatter\"},\"1b9c243c5a24\":{\"colour\":{},\"shape\":{},\"size\":{},\"x\":{},\"y\":{}}},\"source\":\"A\",\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false,\"displaylogo\":false,\"modeBarButtonsToRemove\":[\"sendDataToCloud\",\"select2d\",\"lasso2d\",\"autoScale2d\",\"hoverClosestCartesian\",\"hoverCompareCartesian\",\"sendDataToCloud\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"subplot\":true,\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\nAnd the basic map, shown as a graph, with latitude and longitude of the culture\ncan be visualize with the `ggraph` package.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngraph14_08 <- list()\ngraph14_08 <- within(graph14_08, {\n  # create the graph object\n  # the manual layout requires a special treatment when using ggraph\n  # source for manual layout:\n  # https://stackoverflow.com/questions/67756538/plot-ggraph-using-supplied-node-coordinates\n  # must add the x and y coords to the nodes for manual layout to work\n  the_nodes <- dataKline$nodes_df |>\n    select(culture, x = lon2_pos, y = lat_pos, logpop)\n  the_edges <- dataKline$edges_df\n  # the igraph object\n  grf <- the_edges |>\n    igraph::graph_from_data_frame(directed = FALSE,\n                                  vertices = the_nodes)\n  # the basic graph\n  # we use a special layout, when the x and y have different names to avoid\n  # conflict. See the source on manual layout mentioned above\n  p <- ggraph(grf, layout = data.frame(lx = NA, ly = NA)) +\n    geom_node_point(aes(color = logpop, size = logpop)) +\n    # geom_edge_link() +\n    ggrepel::geom_text_repel(aes(x = x, y = y, label = name), size = 4) +\n    scale_color_paletteer_c(\"pals::isol\") +\n    theme(legend.position = \"none\") +\n  labs(title = \"Relative positions of societies\",\n       x = \"longitude in thousands of km\", y = \"latitude in thousands of km\")\n})\n# glimpse(dataKline$nodes_df)\n# glimpse(dataKline$edges_df)\n# glimpse(dataKline$nodes_df)\n# igraph::vertex.attributes(graph14_08$grf)\n# igraph::edge.attributes(graph14_08$grf)\ngraph14_08$p\n```\n\n::: {.cell-output-display}\n![](ch14_covariances_files/figure-html/ch14_graph14_08-1.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\n#### Model\n\nWe use the scientific model. See section 11.2.1, p. 356, in the Overthinking\nbox.\n\n$$\n\\begin{align*}\nT_i &\\sim \\mathcal{Poisson}(\\lambda_i) \\\\\n\\lambda_i &= \\frac{\\alpha P_i^\\beta}{\\gamma}\n\\end{align*}\n$$\n\nand since we need a varying intercept we had one in a *multiplicative form*. We\ncould simply add it but then it could become negative.\n\n\n$$\n\\begin{align*}\nT_i &\\sim \\mathcal{Poisson}(\\lambda_i) \\\\\n\\lambda_i &= \\exp(k_{society}) \\frac{\\alpha P_i^\\beta}{\\gamma}\n\\end{align*}\n$$\nHere $k_{society}$ is the varying intercept. These intercept are part of\na multivariate distribution. The multivariate intercept prior is defined as\n\n$$\n\\begin{align*}\n\\begin{bmatrix}\nk_1 \\\\\nk_2 \\\\\nk_3 \\\\\n\\vdots \\\\\nk_{10}\n\\end{bmatrix}\n&\\sim\n\\mathcal{MVNormal} \\left(\n\\begin{bmatrix}\n0 \\\\\n0 \\\\\n0 \\\\\n\\vdots \\\\\n0\n\\end{bmatrix}\n,\n\\bf{K}\n\\right) \\\\\n\\bf{K} &= \\eta^2 \\exp(-\\rho^2D_{ij}^2) + \\delta_{ij}\\sigma^2\n\\end{align*}\n$$\n\n::: {.callout-note}\nThe rest of the section comes from @kurtz2020b who did such a fantastic work\nat adapting the wonderful *rethinking* to `brms`. I am so grateful for the \nopportunity to enjoy all this.\n:::\n\n::: {.callout-important}\nThere is a lot more details and info at @kurtz2020b. Please read it to get the\nfull picture.\n:::\n\nWe could have used $D_{ij}$ instead of $D_{ij}^2$ for $\\bf{K}$. $D_{ij}^2$\nbecause of its half-Gaussian shape which is more sigmoidal in shape. As\nillustrated just below.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(data.frame(x = c(0, 4)), aes(x = x)) +\n  stat_function(aes(color = \"-exp(D)\"), fun = function(x) exp(-1 * x), size = 2) +\n  stat_function(aes(color = \"-exp(D^2)\"), fun = function(x) exp(-1 * x^2), size = 2) +\n  scale_color_paletteer_d(\"ggsci::alternating_igv\") +\n  theme(legend.position = c(0.8, 0.8),\n        legend.title = element_blank()) +\n  labs(title = \"Shape of function relating distance to covariance\",\n       x = \"distance\", y = \"correlation\")\n```\n\n::: {.cell-output-display}\n![Figure 14.10](ch14_covariances_files/figure-html/unnamed-chunk-27-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nTherefore we have the model used by `rethinking` and the one by `brms`\n\n##### `rethinking` model\n\n$$\n\\begin{align*}\nT_i &\\sim \\mathcal{Poisson}(\\lambda_i) \\\\\n\\lambda_i &= \\exp(k_{society}) \\frac{\\alpha Population_i^\\beta}{\\gamma} \\\\\n\\begin{bmatrix}\nk_1 \\\\\nk_2 \\\\\nk_3 \\\\\n\\vdots \\\\\nk_{10}\n\\end{bmatrix}\n&\\sim\n\\mathcal{MVNormal}\\left(\n\\begin{bmatrix}\n0 \\\\\n0 \\\\\n0 \\\\\n\\vdots \\\\\n0\n\\end{bmatrix}\n,\n\\bf{K}\n\\right) \\\\\n\\bf{K} &= \\eta^2 \\exp(-\\rho^2Distance_{ij}^2) + \\delta_{ij}\\sigma^2 \\\\\n\\delta_{ij} &= 0 \\implies \\delta_{ij}\\sigma^2 = 0 \\; \\text{because only 1 observation per island} \\\\\n\\alpha, \\beta, \\gamma &\\sim \\mathcal{Exponential}(1) \\\\\n\\eta^2 &\\sim \\mathcal{Exponential}(2) \\\\\n\\rho^2 &\\sim \\mathcal{Exponential}(0.5)\n\\end{align*}\n$$\n##### `brms` model\n\n\n$$\n\\begin{align*}\nT_i &\\sim \\mathcal{Poisson}(\\lambda_i) \\\\\n\\lambda_i &= \\exp(k_{society}) \\frac{\\alpha Population_i^\\beta}{\\gamma} \\\\\n\\begin{bmatrix}\nk_1 \\\\\nk_2 \\\\\nk_3 \\\\\n\\vdots \\\\\nk_{10}\n\\end{bmatrix}\n&\\sim\n\\mathcal{MVNormal} \\left(\n\\begin{bmatrix}\n0 \\\\\n0 \\\\\n0 \\\\\n\\vdots \\\\\n0\n\\end{bmatrix}\n,\n\\bf{K}\n\\right) \\\\\n\\bf{K_{ij}} &= sdgp^2 \\exp \\left(\\frac{-Distance_{ij}^2}{2 \\cdot lscale^2} \\right) \\\\\n\\alpha &\\sim \\mathcal{N}(0, 1) \\\\\n\\beta, \\gamma &\\sim \\mathcal{Exponential}(1) \\\\\nsgdp^2 &\\sim \\mathcal{Exponential}(1) \\\\\nlscale^2 &\\sim \\mathcal{InvGammal}(2.874624, 2.941204)\n\\end{align*}\n$$\n\n\n#### Fit\n\nSince our model is non-linear (scientific formula) then the fit with `brms`\nuses the non-linear form.\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntictoc::tic(msg = sprintf(\"run time of %s, use the cache.\", \"90 secs.\"))\nfit14_08 <- xfun::cache_rds({\n  brm(\n    data = dataKline$nodes_df,\n    family = poisson(link = \"identity\"),\n    formula =  bf(total_tools ~ exp(a) * population^b / g,\n                  a ~ 1 + gp(lat_pos, lon2_pos, scale = FALSE),\n                  b + g ~ 1,\n                  nl = TRUE),\n    prior = c(\n      prior(normal(0, 1), nlpar = a),\n      prior(exponential(1), nlpar = b, lb = 0),\n      prior(exponential(1), nlpar = g, lb = 0),\n      prior(inv_gamma(2.874624, 2.941204), class = lscale, coef = gplat_poslon2_pos, nlpar = a),\n      prior(exponential(1), class = sdgp, coef = gplat_poslon2_pos, nlpar = a)),\n    iter = 2000, warmup = 1000, chains = 2,\n    sample_prior = TRUE,\n    cores = detectCores(), seed = 1433)},\n  file = \"ch14_fit14_08\", rerun = FALSE)\ntictoc::toc()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nrun time of 90 secs., use the cache.: 0.16 sec elapsed\n```\n:::\n:::\n\n\nwhich gives the results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit14_08\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n Family: poisson \n  Links: mu = identity \nFormula: total_tools ~ exp(a) * population^b/g \n         a ~ 1 + gp(lat_pos, lon2_pos, scale = FALSE)\n         b ~ 1\n         g ~ 1\n   Data: dataKline$nodes_df (Number of observations: 10) \n  Draws: 2 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 2000\n\nGaussian Process Terms: \n                            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS\nsdgp(a_gplat_poslon2_pos)       0.50      0.34     0.14     1.42 1.00      628\nlscale(a_gplat_poslon2_pos)     1.69      0.98     0.51     4.29 1.00      643\n                            Tail_ESS\nsdgp(a_gplat_poslon2_pos)       1169\nlscale(a_gplat_poslon2_pos)     1068\n\nPopulation-Level Effects: \n            Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS\na_Intercept     0.37      0.85    -1.32     1.95 1.00     1418     1418\nb_Intercept     0.25      0.09     0.07     0.43 1.00      761      446\ng_Intercept     0.65      0.62     0.06     2.34 1.00     1103      946\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n```\n:::\n:::\n\n\n\nand to have a summary similar to McElreath on p. 472 we can use\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit14_08 |>\n  summarize_draws(\"mean\", \"sd\", ~quantile(.x, probs = c(0.055, 0.945)),\n                  default_convergence_measures()) |>\n  filter(!grepl(\"^lp\", x = variable)) |>\n  mutate(across(.cols = where(is.numeric), .fns = round, digits = 2),\n         across(.cols = starts_with(\"ess\"), .fns = as.integer))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 20 × 8\n   variable                      mean    sd `5.5%` `94.5%`  rhat ess_b…¹ ess_t…²\n   <chr>                        <dbl> <dbl>  <dbl>   <dbl> <dbl>   <int>   <int>\n 1 b_a_Intercept                 0.37  0.85  -1.02    1.68     1    1417    1417\n 2 b_b_Intercept                 0.25  0.09   0.11    0.38     1     761     445\n 3 b_g_Intercept                 0.65  0.62   0.09    1.78     1    1102     946\n 4 sdgp_a_gplat_poslon2_pos      0.5   0.34   0.18    1.09     1     627    1169\n 5 lscale_a_gplat_poslon2_pos    1.69  0.98   0.64    3.52     1     642    1068\n 6 zgp_a_gplat_poslon2_pos[1]   -0.47  0.75  -1.7     0.66     1    1131    1397\n 7 zgp_a_gplat_poslon2_pos[2]    0.44  0.87  -0.99    1.8      1    1521    1190\n 8 zgp_a_gplat_poslon2_pos[3]   -0.62  0.7   -1.65    0.55     1    1335    1371\n 9 zgp_a_gplat_poslon2_pos[4]    0.97  0.68  -0.06    2.1      1    1013    1140\n10 zgp_a_gplat_poslon2_pos[5]    0.24  0.76  -0.91    1.43     1    1366    1307\n11 zgp_a_gplat_poslon2_pos[6]   -1.03  0.79  -2.25    0.27     1    1079     987\n12 zgp_a_gplat_poslon2_pos[7]    0.15  0.68  -0.97    1.2      1    1594    1179\n13 zgp_a_gplat_poslon2_pos[8]   -0.18  0.87  -1.6     1.21     1    2175    1102\n14 zgp_a_gplat_poslon2_pos[9]    0.4   0.92  -1.12    1.81     1    1676    1228\n15 zgp_a_gplat_poslon2_pos[10]  -0.36  0.81  -1.71    0.87     1    1171    1299\n16 prior_b_a                    -0.01  1.01  -1.62    1.58     1    1943    1719\n17 prior_sdgp_a_gplat_poslon2_…  0.98  0.97   0.06    2.85     1    1737    1789\n18 prior_lscale_a__1_gplat_pos…  1.51  1.31   0.49    3.59     1    2190    2046\n19 prior_b_b                     1.01  1.05   0.06    2.95     1    1955    1906\n20 prior_b_g                     1     1.02   0.06    2.96     1    1653    2050\n# … with abbreviated variable names ¹​ess_bulk, ²​ess_tail\n```\n:::\n:::\n\n\nor with `posterior_summary` which is simpler but lacks de ESS\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_summary(fit14_08) |>\n  round(digits = 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                    Estimate Est.Error   Q2.5  Q97.5\nb_a_Intercept                           0.37      0.85  -1.32   1.95\nb_b_Intercept                           0.25      0.09   0.07   0.43\nb_g_Intercept                           0.65      0.62   0.06   2.34\nsdgp_a_gplat_poslon2_pos                0.50      0.34   0.14   1.42\nlscale_a_gplat_poslon2_pos              1.69      0.98   0.51   4.29\nzgp_a_gplat_poslon2_pos[1]             -0.47      0.75  -1.99   0.98\nzgp_a_gplat_poslon2_pos[2]              0.44      0.87  -1.32   2.13\nzgp_a_gplat_poslon2_pos[3]             -0.62      0.70  -1.90   0.94\nzgp_a_gplat_poslon2_pos[4]              0.97      0.68  -0.28   2.39\nzgp_a_gplat_poslon2_pos[5]              0.24      0.76  -1.27   1.77\nzgp_a_gplat_poslon2_pos[6]             -1.03      0.79  -2.55   0.59\nzgp_a_gplat_poslon2_pos[7]              0.15      0.68  -1.27   1.47\nzgp_a_gplat_poslon2_pos[8]             -0.18      0.87  -1.92   1.55\nzgp_a_gplat_poslon2_pos[9]              0.40      0.92  -1.54   2.17\nzgp_a_gplat_poslon2_pos[10]            -0.36      0.81  -1.99   1.20\nprior_b_a                              -0.01      1.01  -1.97   1.87\nprior_sdgp_a_gplat_poslon2_pos          0.98      0.97   0.03   3.68\nprior_lscale_a__1_gplat_poslon2_pos     1.51      1.31   0.40   5.09\nprior_b_b                               1.01      1.05   0.02   3.91\nprior_b_g                               1.00      1.02   0.02   3.73\nlprior                                 -4.02      1.57  -7.77  -2.02\nlp__                                  -51.68      3.42 -59.55 -46.03\n```\n:::\n:::\n\n\n#### Analysis\n\nThe differences with `rethinking` are because `brms` uses non-centering. The\ncoefficient that is really different is the $\\alpha$ in $\\lambda_i = \\exp(k_{society}) \\frac{\\alpha P_i^\\beta}{\\gamma}$.\n\nTo evaluate the differences between `brms` and `rethinking` we can look at what\nthe posterior would be like, without taking into account the covariances.\n\nFor `brms` we have\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop <- as.integer(c(min(dataKline$nodes_df$population),\n             median(dataKline$nodes_df$population),\n             max(dataKline$nodes_df$population)))\ntools <- as.integer(c(min(dataKline$nodes_df$total_tools),\n               mean(dataKline$nodes_df$total_tools),\n               max(dataKline$nodes_df$total_tools)))\na <- fixef(fit14_08)[\"a_Intercept\", \"Estimate\"]\nb <- fixef(fit14_08)[\"b_Intercept\", \"Estimate\"]\ng <- fixef(fit14_08)[\"g_Intercept\", \"Estimate\"]\n# brms uses a different equation for lambda\nl <- exp(a) * pop ^ b / g\nprob_brms <- round(dpois(x = tools, lambda = l), 4)\nprob_brms\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1099 0.0028 0.0027\n```\n:::\n:::\n\nas opposed to `rehinking`` which would give\n\n\n::: {.cell}\n\n```{.r .cell-code}\na <- 1.41\nb <- 0.28\ng <- 0.60\n# rethinking uses a different equation for lambda\nl <- a * pop ^ b / g\nprob_rethink <- round(dpois(x = tools, lambda = l), 4)\nprob_rethink\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.0706 0.0437 0.0331\n```\n:::\n:::\n\n\n\nThe results between the 2 are different and cannot really be compared because\n\n* correlations between $D$ in `rethinking` and $D^2$ in `brms` is not the same and\n* `brms` has a very different way of computing the likelihood\n\nBasically, `rethinking` uses the following definition of $\\bf{K_{ij}}$\n\n$$\n\\bf{K_{ij}} = \\eta^2 \\exp \\left(-\\rho^2D_{ij}^2 \\right) + \\delta_{ij}\\sigma^2\n$$\n\nwhere the term $\\delta_{ij}\\sigma^2$ is used when $i=j$, see p. 470 of @elreath2020.\nIn the oceanic case it is not applicable since we have only one observation per society.\nTherefore the equation is this case is\n\n$$\n\\bf{K_{ij}} = \\eta^2 \\exp \\left(-\\rho^2D_{ij}^2 \\right)\n$$\n\n\nwhereas `brms` uses\n\n\n$$\n\\bf{K_{ij}} = sdgp^2 \\exp \\left(\\frac{-D_{ij}^2}{2 \\cdot lscale^2} \\right)\n$$\n\nand so the 2 equations can be compared as follows\n\n$$\n\\begin{align*}\n\\eta^2 &= sdgp^2 \\\\\n-\\rho^2 &= \\frac{1}{2 \\cdot lscale^2}\n\\end{align*}\n$$\n\nand we note that the distance used can always be found as follows\n\n$$\n\\begin{align*}\n\\bf{K_{ij}} &= sdgp^2 \\exp \\left(\\frac{-D_{ij}^2}{2 \\cdot lscale^2} \\right) \\\\\n\\log \\left( \\bf{K_{ij}} \\right) &= \\log \\left(sdgp^2 \\right) + \\frac{-D_{ij}^2}{2 \\cdot lscale^2} \\\\\nD_{ij}^2 &= 2 \\cdot lscale^2 \\cdot \\left[ \\log \\left(sdgp^2 \\right) - \\log \\left( \\bf{K_{ij}} \\right) \\right]\n\\end{align*}\n$$\n\nand therefore we can figure out the covariance and convert the coefficients \nbetween `brms` and `rethinking``, \n\n\n::: {.cell}\n\n```{.r .cell-code}\npost14_08 <- list()\npost14_08 <- within(post14_08, {\n  # function to compute eta squared as per rethinking\n  rethink_eta2 <- function(sdgp) {\n    sdgp^2\n  }\n  # function to compute rho squared as per rethinking\n  rethink_rho2 <- function(lscale) {\n    -1 / (2 * lscale^2)\n  }\n  # function to calculate the covariance as per brms\n  brms_cov <- function(x, sdgp, lscale) {\n    sdgp^2 * exp(-(x^2) / 2 * lscale^2)\n  }\n})\n```\n:::\n\n\n\nand we transform the posterior data to be able to plot as shown in figure 14.11 on \np. 473\n\n\n::: {.cell}\n\n```{.r .cell-code}\npost14_08 <- within(post14_08, {\n\n  post <- tidy_draws(fit14_08)\n  \n  # the median of the parameters is used later\n  stats <- post |>\n    select(prior_sdgp_a_gplat_poslon2_pos,\n           sdgp_a_gplat_poslon2_pos,\n           prior_lscale_a__1_gplat_poslon2_pos,\n           lscale_a_gplat_poslon2_pos) |>\n    median_qi(.width = 0.89)\n  \n  set.seed(1433)\n  sampl <- post |>\n    select(.draw,\n           prior_sdgp_a_gplat_poslon2_pos,\n           sdgp_a_gplat_poslon2_pos,\n           prior_lscale_a__1_gplat_poslon2_pos,\n           lscale_a_gplat_poslon2_pos) |>\n    mutate(prior_eta2 = rethink_eta2(prior_sdgp_a_gplat_poslon2_pos),\n           eta2 = rethink_eta2(sdgp_a_gplat_poslon2_pos),\n           prior_rho2 = rethink_rho2(prior_lscale_a__1_gplat_poslon2_pos ),\n           rho2 = rethink_rho2(lscale_a_gplat_poslon2_pos)) |>\n    slice_sample(n = 50) |>\n    expand_grid(dist = seq(from = 0, to = 10, by = 0.05)) |>\n    mutate(prior_cov = brms_cov(x = dist,\n                                sdgp = prior_sdgp_a_gplat_poslon2_pos,\n                                lscale = prior_lscale_a__1_gplat_poslon2_pos),\n           cov = brms_cov(x = dist,\n                          sdgp = sdgp_a_gplat_poslon2_pos,\n                          lscale = lscale_a_gplat_poslon2_pos))\n})\n# glimpse(post14_08$stats)\n# glimpse(post14_08$sampl)\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot14_08 <- list()\nplot14_08 <- within(plot14_08, {\n  prior <- post14_08$sampl |> ggplot(aes(x = dist, y = prior_cov)) +\n    geom_line(aes(group = .draw, color = .draw)) +\n    stat_function(\n      fun = function(x) {\n        post14_08$brms_cov(x = median(post14_08$sampl$dist),\n                           sdgp = post14_08$stats$prior_sdgp_a_gplat_poslon2_pos,\n                          lscale = post14_08$stats$prior_lscale_a__1_gplat_poslon2_pos)},\n      color = \"firebrick\", linewidth = 1) +\n    scale_x_continuous(breaks = scales::breaks_width(width = 2),\n                       labels = scales::label_number_auto()) +\n    scale_color_paletteer_c(\"pals::ocean.speed\") +\n    coord_cartesian(ylim = c(0, 2)) +\n    theme(legend.position = \"none\") +\n    labs(title = \"Gaussian process prior\",\n         subtitle = \"Red line is the median of the covariances\",\n         x = \"distance in thousands of km\",\n         y = \"covariance\")\n  post <- post14_08$sampl |> ggplot(aes(x = dist, y = cov)) +\n    geom_line(aes(group = .draw, color = .draw)) +\n    stat_function(\n      fun = function(x) {\n        post14_08$brms_cov(x = median(post14_08$sampl$dist),\n                           sdgp = mean(post14_08$stats$sdgp_a_gplat_poslon2_pos),\n                          lscale = mean(post14_08$stats$lscale_a_gplat_poslon2_pos))},\n      color = \"firebrick\", linewidth = 1) +\n    scale_x_continuous(breaks = scales::breaks_width(width = 2),\n                       labels = scales::label_number_auto()) +\n    scale_color_paletteer_c(\"pals::ocean.speed\") +\n    coord_cartesian(ylim = c(0, 2)) +\n    theme(legend.position = \"none\") +\n    labs(title = \"Gaussian process posterior\",\n         subtitle = \"Red line is the median of the covariances\",\n         x = \"distance in thousands of km\",\n         y = \"covariance\")\n})\nwrap_plots(plot14_08[c(\"prior\", \"post\")]) +\n  plot_annotation(title = \"Oceanic Gaussian Process\") &\n  theme(title = element_text(color = \"darkblue\"))\n```\n\n::: {.cell-output-display}\n![Figure 14.11](ch14_covariances_files/figure-html/ch14_plot14_08-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nand to get the matrix of median covariance we simply map the calculation of\ncovariance using the median values of the parameters\n\n\n::: {.cell}\n\n```{.r .cell-code}\npost14_08 <- within(post14_08, {\n  # the covariance matrix using the median of the parameters\n  # i.e. the median covariance\n  # The covariance is calculated based on the distance\n  cov <- post14_08$brms_cov(\n    x = dataKline$dist,\n    sdgp = post14_08$stats$sdgp_a_gplat_poslon2_pos,\n    lscale = post14_08$stats$lscale_a_gplat_poslon2_pos)\n  # the correlation matrix\n  cor <- cov2cor(cov) |>\n    round(digits = 2)\n})\n# post14_08$cor\n```\n:::\n\n\nwhich we can illustrate with a heatmap\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nheatmaply::heatmaply_cor(\n  x = post14_08$cor,\n  cellnote = post14_08$cor,\n  colors = unclass(paletteer::paletteer_c(\"pals::ocean.tempo\", n = 16)),\n  hide_colorbar = TRUE,\n  main = \"Correlations between Oceanic Societies in Thousands of km\")\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"htmlwidget-941dedb1c69703414464\" style=\"width:100%;height:464px;\" class=\"plotly html-widget\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-941dedb1c69703414464\">{\"x\":{\"data\":[{\"x\":[4.28125,2.25,null,2.25,2.25,null,2.25,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.25,3,null,3,3,null,4.28125,6.3125,null,6.3125,6.3125,null,6.3125,4.5,null,4.5,4.5,null,4.5,4,null,4,4,null,4.5,5,null,5,5,null,6.3125,8.125,null,8.125,8.125,null,8.125,6.75,null,6.75,6.75,null,6.75,6,null,6,6,null,6.75,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8,null,8.125,9.5,null,9.5,9.5,null,9.5,9,null,9,9,null,9.5,10,null,10,10],\"y\":[1.93264068051979,1.93264068051979,null,1.93264068051979,0.510098029794274,null,0.510098029794274,0.510098029794274,null,0.510098029794274,0.230867927612304,null,0.230867927612304,0.230867927612304,null,0.230867927612304,0,null,0.230867927612304,0.230867927612304,null,0.230867927612304,0,null,0.510098029794274,0.510098029794274,null,0.510098029794274,0,null,1.93264068051979,1.93264068051979,null,1.93264068051979,1.62723692190166,null,1.62723692190166,1.62723692190166,null,1.62723692190166,0.700642562224134,null,0.700642562224134,0.700642562224134,null,0.700642562224134,0,null,0.700642562224134,0.700642562224134,null,0.700642562224134,0,null,1.62723692190166,1.62723692190166,null,1.62723692190166,1.50661873080086,null,1.50661873080086,1.50661873080086,null,1.50661873080086,1.43227092409223,null,1.43227092409223,1.43227092409223,null,1.43227092409223,0,null,1.43227092409223,1.43227092409223,null,1.43227092409223,1.30893086142852,null,1.30893086142852,1.30893086142852,null,1.30893086142852,0,null,1.30893086142852,1.30893086142852,null,1.30893086142852,0,null,1.50661873080086,1.50661873080086,null,1.50661873080086,0.775757694128779,null,0.775757694128779,0.775757694128779,null,0.775757694128779,0,null,0.775757694128779,0.775757694128779,null,0.775757694128779,0],\"text\":[\"y: 1.9326407\",\"y: 1.9326407\",null,\"y: 1.9326407\",\"y: 1.9326407\",null,\"y: 0.5100980\",\"y: 0.5100980\",null,\"y: 0.5100980\",\"y: 0.5100980\",null,\"y: 0.2308679\",\"y: 0.2308679\",null,\"y: 0.2308679\",\"y: 0.2308679\",null,\"y: 0.2308679\",\"y: 0.2308679\",null,\"y: 0.2308679\",\"y: 0.2308679\",null,\"y: 0.5100980\",\"y: 0.5100980\",null,\"y: 0.5100980\",\"y: 0.5100980\",null,\"y: 1.9326407\",\"y: 1.9326407\",null,\"y: 1.9326407\",\"y: 1.9326407\",null,\"y: 1.6272369\",\"y: 1.6272369\",null,\"y: 1.6272369\",\"y: 1.6272369\",null,\"y: 0.7006426\",\"y: 0.7006426\",null,\"y: 0.7006426\",\"y: 0.7006426\",null,\"y: 0.7006426\",\"y: 0.7006426\",null,\"y: 0.7006426\",\"y: 0.7006426\",null,\"y: 1.6272369\",\"y: 1.6272369\",null,\"y: 1.6272369\",\"y: 1.6272369\",null,\"y: 1.5066187\",\"y: 1.5066187\",null,\"y: 1.5066187\",\"y: 1.5066187\",null,\"y: 1.4322709\",\"y: 1.4322709\",null,\"y: 1.4322709\",\"y: 1.4322709\",null,\"y: 1.4322709\",\"y: 1.4322709\",null,\"y: 1.4322709\",\"y: 1.4322709\",null,\"y: 1.3089309\",\"y: 1.3089309\",null,\"y: 1.3089309\",\"y: 1.3089309\",null,\"y: 1.3089309\",\"y: 1.3089309\",null,\"y: 1.3089309\",\"y: 1.3089309\",null,\"y: 1.5066187\",\"y: 1.5066187\",null,\"y: 1.5066187\",\"y: 1.5066187\",null,\"y: 0.7757577\",\"y: 0.7757577\",null,\"y: 0.7757577\",\"y: 0.7757577\",null,\"y: 0.7757577\",\"y: 0.7757577\",null,\"y: 0.7757577\",\"y: 0.7757577\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.26771653543307,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[4.28125,2.25,1.5,1,2,3,6.3125,4.5,4,5,8.125,6.75,6,7.5,7,8,9.5,9,10],\"y\":[1.93264068051979,0.510098029794274,0.230867927612304,0,0,0,1.62723692190166,0.700642562224134,0,0,1.50661873080086,1.43227092409223,0,1.30893086142852,0,0,0.775757694128779,0,0],\"text\":[\"y: 1.9326407\",\"y: 0.5100980\",\"y: 0.2308679\",\"y: 0.0000000\",\"y: 0.0000000\",\"y: 0.0000000\",\"y: 1.6272369\",\"y: 0.7006426\",\"y: 0.0000000\",\"y: 0.0000000\",\"y: 1.5066187\",\"y: 1.4322709\",\"y: 0.0000000\",\"y: 1.3089309\",\"y: 0.0000000\",\"y: 0.0000000\",\"y: 0.7757577\",\"y: 0.0000000\",\"y: 0.0000000\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"transparent\",\"opacity\":1,\"size\":null,\"symbol\":null,\"line\":{\"width\":1.88976377952756,\"color\":\"transparent\"}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(44,160,44,1)\",\"line\":{\"color\":\"rgba(44,160,44,1)\"}},\"error_y\":{\"color\":\"rgba(44,160,44,1)\"},\"error_x\":{\"color\":\"rgba(44,160,44,1)\"},\"line\":{\"color\":\"rgba(44,160,44,1)\"},\"xaxis\":\"x2\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[1,2,3,4,5,6,7,8,9,10],\"y\":[1,2,3,4,5,6,7,8,9,10],\"z\":[[1,0.9,0.66,0.08,0,0,0,0,0,0.05],[0.9,1,0.79,0.2,0.02,0,0,0,0,0.01],[0.66,0.79,1,0.2,0.03,0,0,0,0,0.01],[0.08,0.2,0.2,1,0.54,0,0,0,0,0],[0,0.02,0.03,0.54,1,0,0,0,0,0],[0,0,0,0,0,1,0,0,0,0],[0,0,0,0,0,0,1,0.08,0.07,0],[0,0,0,0,0,0,0.08,1,0.21,0.03],[0,0,0,0,0,0,0.07,0.21,1,0.47],[0.05,0.01,0.01,0,0,0,0,0.03,0.47,1]],\"text\":[[\"row: Santa Cruz<br>column: Santa Cruz<br>value: 1.00\",\"row: Santa Cruz<br>column: Tikopia<br>value: 0.90\",\"row: Santa Cruz<br>column: Malekula<br>value: 0.66\",\"row: Santa Cruz<br>column: Lau Fiji<br>value: 0.08\",\"row: Santa Cruz<br>column: Tonga<br>value: 0.00\",\"row: Santa Cruz<br>column: Hawaii<br>value: 0.00\",\"row: Santa Cruz<br>column: Yap<br>value: 0.00\",\"row: Santa Cruz<br>column: Chuuk<br>value: 0.00\",\"row: Santa Cruz<br>column: Manus<br>value: 0.00\",\"row: Santa Cruz<br>column: Trobriand<br>value: 0.05\"],[\"row: Tikopia<br>column: Santa Cruz<br>value: 0.90\",\"row: Tikopia<br>column: Tikopia<br>value: 1.00\",\"row: Tikopia<br>column: Malekula<br>value: 0.79\",\"row: Tikopia<br>column: Lau Fiji<br>value: 0.20\",\"row: Tikopia<br>column: Tonga<br>value: 0.02\",\"row: Tikopia<br>column: Hawaii<br>value: 0.00\",\"row: Tikopia<br>column: Yap<br>value: 0.00\",\"row: Tikopia<br>column: Chuuk<br>value: 0.00\",\"row: Tikopia<br>column: Manus<br>value: 0.00\",\"row: Tikopia<br>column: Trobriand<br>value: 0.01\"],[\"row: Malekula<br>column: Santa Cruz<br>value: 0.66\",\"row: Malekula<br>column: Tikopia<br>value: 0.79\",\"row: Malekula<br>column: Malekula<br>value: 1.00\",\"row: Malekula<br>column: Lau Fiji<br>value: 0.20\",\"row: Malekula<br>column: Tonga<br>value: 0.03\",\"row: Malekula<br>column: Hawaii<br>value: 0.00\",\"row: Malekula<br>column: Yap<br>value: 0.00\",\"row: Malekula<br>column: Chuuk<br>value: 0.00\",\"row: Malekula<br>column: Manus<br>value: 0.00\",\"row: Malekula<br>column: Trobriand<br>value: 0.01\"],[\"row: Lau Fiji<br>column: Santa Cruz<br>value: 0.08\",\"row: Lau Fiji<br>column: Tikopia<br>value: 0.20\",\"row: Lau Fiji<br>column: Malekula<br>value: 0.20\",\"row: Lau Fiji<br>column: Lau Fiji<br>value: 1.00\",\"row: Lau Fiji<br>column: Tonga<br>value: 0.54\",\"row: Lau Fiji<br>column: Hawaii<br>value: 0.00\",\"row: Lau Fiji<br>column: Yap<br>value: 0.00\",\"row: Lau Fiji<br>column: Chuuk<br>value: 0.00\",\"row: Lau Fiji<br>column: Manus<br>value: 0.00\",\"row: Lau Fiji<br>column: Trobriand<br>value: 0.00\"],[\"row: Tonga<br>column: Santa Cruz<br>value: 0.00\",\"row: Tonga<br>column: Tikopia<br>value: 0.02\",\"row: Tonga<br>column: Malekula<br>value: 0.03\",\"row: Tonga<br>column: Lau Fiji<br>value: 0.54\",\"row: Tonga<br>column: Tonga<br>value: 1.00\",\"row: Tonga<br>column: Hawaii<br>value: 0.00\",\"row: Tonga<br>column: Yap<br>value: 0.00\",\"row: Tonga<br>column: Chuuk<br>value: 0.00\",\"row: Tonga<br>column: Manus<br>value: 0.00\",\"row: Tonga<br>column: Trobriand<br>value: 0.00\"],[\"row: Hawaii<br>column: Santa Cruz<br>value: 0.00\",\"row: Hawaii<br>column: Tikopia<br>value: 0.00\",\"row: Hawaii<br>column: Malekula<br>value: 0.00\",\"row: Hawaii<br>column: Lau Fiji<br>value: 0.00\",\"row: Hawaii<br>column: Tonga<br>value: 0.00\",\"row: Hawaii<br>column: Hawaii<br>value: 1.00\",\"row: Hawaii<br>column: Yap<br>value: 0.00\",\"row: Hawaii<br>column: Chuuk<br>value: 0.00\",\"row: Hawaii<br>column: Manus<br>value: 0.00\",\"row: Hawaii<br>column: Trobriand<br>value: 0.00\"],[\"row: Yap<br>column: Santa Cruz<br>value: 0.00\",\"row: Yap<br>column: Tikopia<br>value: 0.00\",\"row: Yap<br>column: Malekula<br>value: 0.00\",\"row: Yap<br>column: Lau Fiji<br>value: 0.00\",\"row: Yap<br>column: Tonga<br>value: 0.00\",\"row: Yap<br>column: Hawaii<br>value: 0.00\",\"row: Yap<br>column: Yap<br>value: 1.00\",\"row: Yap<br>column: Chuuk<br>value: 0.08\",\"row: Yap<br>column: Manus<br>value: 0.07\",\"row: Yap<br>column: Trobriand<br>value: 0.00\"],[\"row: Chuuk<br>column: Santa Cruz<br>value: 0.00\",\"row: Chuuk<br>column: Tikopia<br>value: 0.00\",\"row: Chuuk<br>column: Malekula<br>value: 0.00\",\"row: Chuuk<br>column: Lau Fiji<br>value: 0.00\",\"row: Chuuk<br>column: Tonga<br>value: 0.00\",\"row: Chuuk<br>column: Hawaii<br>value: 0.00\",\"row: Chuuk<br>column: Yap<br>value: 0.08\",\"row: Chuuk<br>column: Chuuk<br>value: 1.00\",\"row: Chuuk<br>column: Manus<br>value: 0.21\",\"row: Chuuk<br>column: Trobriand<br>value: 0.03\"],[\"row: Manus<br>column: Santa Cruz<br>value: 0.00\",\"row: Manus<br>column: Tikopia<br>value: 0.00\",\"row: Manus<br>column: Malekula<br>value: 0.00\",\"row: Manus<br>column: Lau Fiji<br>value: 0.00\",\"row: Manus<br>column: Tonga<br>value: 0.00\",\"row: Manus<br>column: Hawaii<br>value: 0.00\",\"row: Manus<br>column: Yap<br>value: 0.07\",\"row: Manus<br>column: Chuuk<br>value: 0.21\",\"row: Manus<br>column: Manus<br>value: 1.00\",\"row: Manus<br>column: Trobriand<br>value: 0.47\"],[\"row: Trobriand<br>column: Santa Cruz<br>value: 0.05\",\"row: Trobriand<br>column: Tikopia<br>value: 0.01\",\"row: Trobriand<br>column: Malekula<br>value: 0.01\",\"row: Trobriand<br>column: Lau Fiji<br>value: 0.00\",\"row: Trobriand<br>column: Tonga<br>value: 0.00\",\"row: Trobriand<br>column: Hawaii<br>value: 0.00\",\"row: Trobriand<br>column: Yap<br>value: 0.00\",\"row: Trobriand<br>column: Chuuk<br>value: 0.03\",\"row: Trobriand<br>column: Manus<br>value: 0.47\",\"row: Trobriand<br>column: Trobriand<br>value: 1.00\"]],\"colorscale\":[[0,\"#31927F\"],[0.01,\"#2F917E\"],[0.02,\"#2D907E\"],[0.03,\"#2B8F7E\"],[0.05,\"#268D7D\"],[0.07,\"#228B7D\"],[0.08,\"#218A7D\"],[0.2,\"#147D78\"],[0.21,\"#147C77\"],[0.47,\"#195C69\"],[0.54,\"#1A5463\"],[0.66,\"#1B465B\"],[0.79,\"#1A3652\"],[0.9,\"#17294B\"],[1,\"#151D44\"]],\"type\":\"heatmap\",\"showscale\":false,\"autocolorscale\":false,\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1],\"y\":[1],\"name\":\"99_4a345e117846d145ab64810d2e16f4a3\",\"type\":\"scatter\",\"mode\":\"markers\",\"opacity\":0,\"hoverinfo\":\"skip\",\"showlegend\":false,\"marker\":{\"color\":[0,1],\"colorscale\":[[0,\"#FFF6F4\"],[0.00334448160535117,\"#FEF5F3\"],[0.00668896321070234,\"#FCF4F1\"],[0.0100334448160535,\"#FBF4F0\"],[0.0133779264214047,\"#FAF3EF\"],[0.0167224080267558,\"#F9F2EE\"],[0.020066889632107,\"#F7F1EC\"],[0.0234113712374582,\"#F6F0EB\"],[0.0267558528428093,\"#F5F0EA\"],[0.0301003344481605,\"#F4EFE9\"],[0.0334448160535117,\"#F2EEE7\"],[0.0367892976588629,\"#F1EDE6\"],[0.040133779264214,\"#F0ECE5\"],[0.0434782608695652,\"#EFECE4\"],[0.0468227424749164,\"#EDEBE2\"],[0.0501672240802676,\"#ECEAE1\"],[0.0535117056856187,\"#EBE9E0\"],[0.0568561872909699,\"#EAE8DF\"],[0.0602006688963211,\"#E8E8DD\"],[0.0635451505016723,\"#E7E7DC\"],[0.0668896321070234,\"#E6E6DB\"],[0.0702341137123746,\"#E5E5DA\"],[0.0735785953177258,\"#E3E4D8\"],[0.0769230769230769,\"#E2E4D7\"],[0.0802675585284281,\"#E1E3D6\"],[0.0836120401337793,\"#E0E2D5\"],[0.0869565217391304,\"#DFE1D4\"],[0.0903010033444816,\"#DDE1D2\"],[0.0936454849498328,\"#DCE0D1\"],[0.0969899665551839,\"#DBDFD0\"],[0.100334448160535,\"#DADECF\"],[0.103678929765886,\"#D9DECE\"],[0.107023411371237,\"#D7DDCC\"],[0.110367892976589,\"#D6DCCB\"],[0.11371237458194,\"#D5DBCA\"],[0.117056856187291,\"#D4DBC9\"],[0.120401337792642,\"#D3DAC8\"],[0.123745819397993,\"#D1D9C6\"],[0.127090301003345,\"#D0D8C5\"],[0.130434782608696,\"#CFD8C4\"],[0.133779264214047,\"#CED7C3\"],[0.137123745819398,\"#CDD6C2\"],[0.140468227424749,\"#CBD6C1\"],[0.1438127090301,\"#CAD5C0\"],[0.147157190635452,\"#C9D4BF\"],[0.150501672240803,\"#C7D4BE\"],[0.153846153846154,\"#C6D3BD\"],[0.157190635451505,\"#C5D2BC\"],[0.160535117056856,\"#C3D2BB\"],[0.163879598662207,\"#C2D1BA\"],[0.167224080267559,\"#C1D0B9\"],[0.17056856187291,\"#BFD0B8\"],[0.173913043478261,\"#BECFB7\"],[0.177257525083612,\"#BDCEB6\"],[0.180602006688963,\"#BCCEB5\"],[0.183946488294314,\"#BACDB5\"],[0.187290969899666,\"#B9CCB4\"],[0.190635451505017,\"#B8CCB3\"],[0.193979933110368,\"#B6CBB2\"],[0.197324414715719,\"#B5CBB1\"],[0.20066889632107,\"#B4CAB0\"],[0.204013377926421,\"#B2C9AF\"],[0.207357859531773,\"#B1C9AE\"],[0.210702341137124,\"#B0C8AD\"],[0.214046822742475,\"#AEC7AC\"],[0.217391304347826,\"#ADC7AB\"],[0.220735785953177,\"#ACC6AA\"],[0.224080267558528,\"#AAC6A9\"],[0.22742474916388,\"#A9C5A9\"],[0.230769230769231,\"#A8C4A8\"],[0.234113712374582,\"#A6C4A7\"],[0.237458193979933,\"#A5C3A6\"],[0.240802675585284,\"#A4C3A5\"],[0.244147157190635,\"#A2C2A4\"],[0.247491638795987,\"#A1C1A3\"],[0.250836120401338,\"#9FC1A2\"],[0.254180602006689,\"#9EC0A1\"],[0.25752508361204,\"#9DC0A0\"],[0.260869565217391,\"#9BBFA0\"],[0.264214046822742,\"#9ABE9F\"],[0.267558528428094,\"#99BE9E\"],[0.270903010033445,\"#97BD9D\"],[0.274247491638796,\"#96BD9D\"],[0.277591973244147,\"#94BC9C\"],[0.280936454849498,\"#93BB9B\"],[0.284280936454849,\"#91BB9B\"],[0.287625418060201,\"#90BA9A\"],[0.290969899665552,\"#8EBA99\"],[0.294314381270903,\"#8DB999\"],[0.297658862876254,\"#8BB898\"],[0.301003344481605,\"#8AB897\"],[0.304347826086957,\"#88B797\"],[0.307692307692308,\"#87B796\"],[0.311036789297659,\"#85B695\"],[0.31438127090301,\"#84B595\"],[0.317725752508361,\"#82B594\"],[0.321070234113712,\"#81B493\"],[0.324414715719064,\"#7FB493\"],[0.327759197324415,\"#7EB392\"],[0.331103678929766,\"#7CB291\"],[0.334448160535117,\"#7BB291\"],[0.337792642140468,\"#79B190\"],[0.341137123745819,\"#78B190\"],[0.344481605351171,\"#76B08F\"],[0.347826086956522,\"#75AF8F\"],[0.351170568561873,\"#73AF8E\"],[0.354515050167224,\"#72AE8E\"],[0.357859531772575,\"#70AE8D\"],[0.361204013377926,\"#6EAD8D\"],[0.364548494983278,\"#6DAC8C\"],[0.367892976588629,\"#6BAC8C\"],[0.37123745819398,\"#6AAB8B\"],[0.374581939799331,\"#68AB8B\"],[0.377926421404682,\"#67AA8A\"],[0.381270903010033,\"#65A98A\"],[0.384615384615385,\"#63A989\"],[0.387959866220736,\"#62A889\"],[0.391304347826087,\"#60A888\"],[0.394648829431438,\"#5FA788\"],[0.397993311036789,\"#5DA687\"],[0.40133779264214,\"#5BA687\"],[0.404682274247492,\"#5AA587\"],[0.408026755852843,\"#59A486\"],[0.411371237458194,\"#57A486\"],[0.414715719063545,\"#56A385\"],[0.418060200668896,\"#54A285\"],[0.421404682274247,\"#53A285\"],[0.424749163879599,\"#52A184\"],[0.42809364548495,\"#50A184\"],[0.431438127090301,\"#4FA084\"],[0.434782608695652,\"#4D9F83\"],[0.438127090301003,\"#4C9F83\"],[0.441471571906354,\"#4A9E83\"],[0.444816053511706,\"#499D82\"],[0.448160535117057,\"#479D82\"],[0.451505016722408,\"#459C82\"],[0.454849498327759,\"#449B81\"],[0.45819397993311,\"#429B81\"],[0.461538461538462,\"#419A81\"],[0.464882943143813,\"#3F9980\"],[0.468227424749164,\"#3D9980\"],[0.471571906354515,\"#3C9880\"],[0.474916387959866,\"#3B9780\"],[0.478260869565217,\"#3A977F\"],[0.481605351170569,\"#39967F\"],[0.48494983277592,\"#37957F\"],[0.488294314381271,\"#36947F\"],[0.491638795986622,\"#35947F\"],[0.494983277591973,\"#33937F\"],[0.498327759197324,\"#32927F\"],[0.501672240802676,\"#31927E\"],[0.505016722408027,\"#2F917E\"],[0.508361204013378,\"#2E907E\"],[0.511705685618729,\"#2C907E\"],[0.51505016722408,\"#2B8F7E\"],[0.518394648829431,\"#298E7E\"],[0.521739130434783,\"#288D7E\"],[0.525083612040134,\"#268D7D\"],[0.528428093645485,\"#258C7D\"],[0.531772575250836,\"#238B7D\"],[0.535117056856187,\"#228B7D\"],[0.538461538461538,\"#218A7D\"],[0.54180602006689,\"#20897C\"],[0.545150501672241,\"#20887C\"],[0.548494983277592,\"#1F887C\"],[0.551839464882943,\"#1F877C\"],[0.555183946488294,\"#1E867B\"],[0.558528428093645,\"#1D867B\"],[0.561872909698997,\"#1D857B\"],[0.565217391304348,\"#1C847B\"],[0.568561872909699,\"#1B847A\"],[0.57190635451505,\"#1A837A\"],[0.575250836120401,\"#1A827A\"],[0.578595317725752,\"#19817A\"],[0.581939799331104,\"#188179\"],[0.585284280936455,\"#188079\"],[0.588628762541806,\"#177F79\"],[0.591973244147157,\"#167F79\"],[0.595317725752508,\"#157E78\"],[0.598662207357859,\"#147D78\"],[0.602006688963211,\"#147C78\"],[0.605351170568562,\"#147C77\"],[0.608695652173913,\"#157B77\"],[0.612040133779264,\"#157A77\"],[0.615384615384615,\"#157976\"],[0.618729096989967,\"#157876\"],[0.622073578595318,\"#157776\"],[0.625418060200669,\"#167675\"],[0.62876254180602,\"#167675\"],[0.632107023411371,\"#167575\"],[0.635451505016722,\"#167474\"],[0.638795986622074,\"#167374\"],[0.642140468227425,\"#167274\"],[0.645484949832776,\"#167173\"],[0.648829431438127,\"#177173\"],[0.652173913043478,\"#177073\"],[0.655518394648829,\"#176F72\"],[0.658862876254181,\"#176E72\"],[0.662207357859532,\"#176D71\"],[0.665551839464883,\"#176C71\"],[0.668896321070234,\"#176B71\"],[0.672240802675585,\"#176B70\"],[0.675585284280936,\"#176A70\"],[0.678929765886288,\"#186970\"],[0.682274247491639,\"#18686F\"],[0.68561872909699,\"#18676F\"],[0.688963210702341,\"#18676E\"],[0.692307692307692,\"#18666E\"],[0.695652173913043,\"#18656E\"],[0.698996655518395,\"#18646D\"],[0.702341137123746,\"#18636D\"],[0.705685618729097,\"#18636C\"],[0.709030100334448,\"#19626C\"],[0.712374581939799,\"#19616C\"],[0.71571906354515,\"#19606B\"],[0.719063545150502,\"#195F6B\"],[0.722408026755853,\"#195F6A\"],[0.725752508361204,\"#195E6A\"],[0.729096989966555,\"#195D6A\"],[0.732441471571906,\"#195C69\"],[0.735785953177257,\"#195B69\"],[0.739130434782609,\"#195B68\"],[0.74247491638796,\"#195A68\"],[0.745819397993311,\"#195967\"],[0.749163879598662,\"#195867\"],[0.752508361204013,\"#195866\"],[0.755852842809364,\"#1A5766\"],[0.759197324414716,\"#1A5665\"],[0.762541806020067,\"#1A5565\"],[0.765886287625418,\"#1A5564\"],[0.769230769230769,\"#1A5464\"],[0.77257525083612,\"#1A5363\"],[0.775919732441472,\"#1A5263\"],[0.779264214046823,\"#1A5262\"],[0.782608695652174,\"#1A5162\"],[0.785953177257525,\"#1A5061\"],[0.789297658862876,\"#1A4F61\"],[0.792642140468227,\"#1A4F60\"],[0.795986622073579,\"#1A4E60\"],[0.79933110367893,\"#1A4D5F\"],[0.802675585284281,\"#1A4C5F\"],[0.806020066889632,\"#1A4C5E\"],[0.809364548494983,\"#1A4B5E\"],[0.812709030100334,\"#1A4A5D\"],[0.816053511705686,\"#1A495D\"],[0.819397993311037,\"#1B485C\"],[0.822742474916388,\"#1B475C\"],[0.826086956521739,\"#1B475B\"],[0.82943143812709,\"#1B465B\"],[0.832775919732441,\"#1B455B\"],[0.836120401337793,\"#1B445A\"],[0.839464882943144,\"#1B435A\"],[0.842809364548495,\"#1B4359\"],[0.846153846153846,\"#1B4259\"],[0.849498327759197,\"#1B4158\"],[0.852842809364548,\"#1B4058\"],[0.8561872909699,\"#1B3F57\"],[0.859531772575251,\"#1B3F57\"],[0.862876254180602,\"#1B3E57\"],[0.866220735785953,\"#1B3D56\"],[0.869565217391304,\"#1B3C56\"],[0.872909698996655,\"#1B3B55\"],[0.876254180602007,\"#1B3B55\"],[0.879598662207358,\"#1B3A54\"],[0.882943143812709,\"#1A3954\"],[0.88628762541806,\"#1A3853\"],[0.889632107023411,\"#1A3753\"],[0.892976588628763,\"#1A3752\"],[0.896321070234114,\"#1A3652\"],[0.899665551839465,\"#1A3552\"],[0.903010033444816,\"#1A3451\"],[0.906354515050167,\"#193351\"],[0.909698996655518,\"#193350\"],[0.91304347826087,\"#193250\"],[0.916387959866221,\"#19314F\"],[0.919732441471572,\"#19304F\"],[0.923076923076923,\"#192F4E\"],[0.926421404682274,\"#182F4E\"],[0.929765886287625,\"#182E4D\"],[0.933110367892977,\"#182D4D\"],[0.936454849498328,\"#182C4D\"],[0.939799331103679,\"#182B4C\"],[0.94314381270903,\"#182B4C\"],[0.946488294314381,\"#182A4B\"],[0.949832775919732,\"#17294B\"],[0.953177257525084,\"#17284A\"],[0.956521739130435,\"#17274A\"],[0.959866220735786,\"#172749\"],[0.963210702341137,\"#172649\"],[0.966555183946488,\"#172549\"],[0.969899665551839,\"#172448\"],[0.973244147157191,\"#162348\"],[0.976588628762542,\"#162347\"],[0.979933110367893,\"#162247\"],[0.983277591973244,\"#162146\"],[0.986622073578595,\"#162046\"],[0.989966555183946,\"#161F45\"],[0.993311036789298,\"#151F45\"],[0.996655518394649,\"#151E44\"],[1,\"#151D44\"]],\"colorbar\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"thickness\":23.04,\"title\":null,\"titlefont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187},\"tickmode\":\"array\",\"ticktext\":[\"-1.0\",\"-0.5\",\"0.0\",\"0.5\",\"1.0\"],\"tickvals\":[0,0.25,0.5,0.75,1],\"tickfont\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.689497716895},\"ticklen\":2,\"len\":0.5},\"showscale\":false},\"xaxis\":\"x\",\"yaxis\":\"y2\",\"frame\":null},{\"x\":[1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10],\"y\":[1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10],\"text\":[\"1\",\"0.9\",\"0.66\",\"0.08\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0.05\",\"0.9\",\"1\",\"0.79\",\"0.2\",\"0.02\",\"0\",\"0\",\"0\",\"0\",\"0.01\",\"0.66\",\"0.79\",\"1\",\"0.2\",\"0.03\",\"0\",\"0\",\"0\",\"0\",\"0.01\",\"0.08\",\"0.2\",\"0.2\",\"1\",\"0.54\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0.02\",\"0.03\",\"0.54\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"1\",\"0.08\",\"0.07\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0.08\",\"1\",\"0.21\",\"0.03\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0\",\"0.07\",\"0.21\",\"1\",\"0.47\",\"0.05\",\"0.01\",\"0.01\",\"0\",\"0\",\"0\",\"0\",\"0.03\",\"0.47\",\"1\"],\"customdata\":[1,0.9,0.66,0.08,0,0,0,0,0,0.05,0.9,1,0.79,0.2,0.02,0,0,0,0,0.01,0.66,0.79,1,0.2,0.03,0,0,0,0,0.01,0.08,0.2,0.2,1,0.54,0,0,0,0,0,0,0.02,0.03,0.54,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0.08,0.07,0,0,0,0,0,0,0,0.08,1,0.21,0.03,0,0,0,0,0,0,0.07,0.21,1,0.47,0.05,0.01,0.01,0,0,0,0,0.03,0.47,1],\"type\":\"scatter\",\"mode\":\"text\",\"textposition\":[\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\",\"middle right\"],\"hovertemplate\":[\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\"],\"showlegend\":false,\"textfont\":{\"color\":[\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\"],\"size\":12},\"marker\":{\"color\":\"rgba(140,86,75,1)\",\"line\":{\"color\":\"rgba(140,86,75,1)\"},\"showscale\":false},\"error_y\":{\"color\":\"rgba(140,86,75,1)\"},\"error_x\":{\"color\":\"rgba(140,86,75,1)\"},\"line\":{\"color\":\"rgba(140,86,75,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y2\",\"frame\":null},{\"x\":[1.93264068051979,1.93264068051979,null,1.93264068051979,0.510098029794274,null,0.510098029794274,0.510098029794274,null,0.510098029794274,0.230867927612304,null,0.230867927612304,0.230867927612304,null,0.230867927612304,0,null,0.230867927612304,0.230867927612304,null,0.230867927612304,0,null,0.510098029794274,0.510098029794274,null,0.510098029794274,0,null,1.93264068051979,1.93264068051979,null,1.93264068051979,1.62723692190166,null,1.62723692190166,1.62723692190166,null,1.62723692190166,0.700642562224134,null,0.700642562224134,0.700642562224134,null,0.700642562224134,0,null,0.700642562224134,0.700642562224134,null,0.700642562224134,0,null,1.62723692190166,1.62723692190166,null,1.62723692190166,1.50661873080086,null,1.50661873080086,1.50661873080086,null,1.50661873080086,1.43227092409223,null,1.43227092409223,1.43227092409223,null,1.43227092409223,0,null,1.43227092409223,1.43227092409223,null,1.43227092409223,1.30893086142852,null,1.30893086142852,1.30893086142852,null,1.30893086142852,0,null,1.30893086142852,1.30893086142852,null,1.30893086142852,0,null,1.50661873080086,1.50661873080086,null,1.50661873080086,0.775757694128779,null,0.775757694128779,0.775757694128779,null,0.775757694128779,0,null,0.775757694128779,0.775757694128779,null,0.775757694128779,0],\"y\":[4.28125,2.25,null,2.25,2.25,null,2.25,1.5,null,1.5,1.5,null,1.5,1,null,1,1,null,1.5,2,null,2,2,null,2.25,3,null,3,3,null,4.28125,6.3125,null,6.3125,6.3125,null,6.3125,4.5,null,4.5,4.5,null,4.5,4,null,4,4,null,4.5,5,null,5,5,null,6.3125,8.125,null,8.125,8.125,null,8.125,6.75,null,6.75,6.75,null,6.75,6,null,6,6,null,6.75,7.5,null,7.5,7.5,null,7.5,7,null,7,7,null,7.5,8,null,8,8,null,8.125,9.5,null,9.5,9.5,null,9.5,9,null,9,9,null,9.5,10,null,10,10],\"text\":[\"y: 1.9326407\",\"y: 1.9326407\",null,\"y: 1.9326407\",\"y: 1.9326407\",null,\"y: 0.5100980\",\"y: 0.5100980\",null,\"y: 0.5100980\",\"y: 0.5100980\",null,\"y: 0.2308679\",\"y: 0.2308679\",null,\"y: 0.2308679\",\"y: 0.2308679\",null,\"y: 0.2308679\",\"y: 0.2308679\",null,\"y: 0.2308679\",\"y: 0.2308679\",null,\"y: 0.5100980\",\"y: 0.5100980\",null,\"y: 0.5100980\",\"y: 0.5100980\",null,\"y: 1.9326407\",\"y: 1.9326407\",null,\"y: 1.9326407\",\"y: 1.9326407\",null,\"y: 1.6272369\",\"y: 1.6272369\",null,\"y: 1.6272369\",\"y: 1.6272369\",null,\"y: 0.7006426\",\"y: 0.7006426\",null,\"y: 0.7006426\",\"y: 0.7006426\",null,\"y: 0.7006426\",\"y: 0.7006426\",null,\"y: 0.7006426\",\"y: 0.7006426\",null,\"y: 1.6272369\",\"y: 1.6272369\",null,\"y: 1.6272369\",\"y: 1.6272369\",null,\"y: 1.5066187\",\"y: 1.5066187\",null,\"y: 1.5066187\",\"y: 1.5066187\",null,\"y: 1.4322709\",\"y: 1.4322709\",null,\"y: 1.4322709\",\"y: 1.4322709\",null,\"y: 1.4322709\",\"y: 1.4322709\",null,\"y: 1.4322709\",\"y: 1.4322709\",null,\"y: 1.3089309\",\"y: 1.3089309\",null,\"y: 1.3089309\",\"y: 1.3089309\",null,\"y: 1.3089309\",\"y: 1.3089309\",null,\"y: 1.3089309\",\"y: 1.3089309\",null,\"y: 1.5066187\",\"y: 1.5066187\",null,\"y: 1.5066187\",\"y: 1.5066187\",null,\"y: 0.7757577\",\"y: 0.7757577\",null,\"y: 0.7757577\",\"y: 0.7757577\",null,\"y: 0.7757577\",\"y: 0.7757577\",null,\"y: 0.7757577\",\"y: 0.7757577\"],\"type\":\"scatter\",\"mode\":\"lines\",\"line\":{\"width\":2.26771653543307,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null},{\"x\":[1.93264068051979,0.510098029794274,0.230867927612304,0,0,0,1.62723692190166,0.700642562224134,0,0,1.50661873080086,1.43227092409223,0,1.30893086142852,0,0,0.775757694128779,0,0],\"y\":[4.28125,2.25,1.5,1,2,3,6.3125,4.5,4,5,8.125,6.75,6,7.5,7,8,9.5,9,10],\"text\":[\"y: 1.9326407\",\"y: 0.5100980\",\"y: 0.2308679\",\"y: 0.0000000\",\"y: 0.0000000\",\"y: 0.0000000\",\"y: 1.6272369\",\"y: 0.7006426\",\"y: 0.0000000\",\"y: 0.0000000\",\"y: 1.5066187\",\"y: 1.4322709\",\"y: 0.0000000\",\"y: 1.3089309\",\"y: 0.0000000\",\"y: 0.0000000\",\"y: 0.7757577\",\"y: 0.0000000\",\"y: 0.0000000\"],\"type\":\"scatter\",\"mode\":\"markers\",\"marker\":{\"autocolorscale\":false,\"color\":\"transparent\",\"opacity\":1,\"size\":null,\"symbol\":null,\"line\":{\"width\":1.88976377952756,\"color\":\"transparent\"}},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x2\",\"yaxis\":\"y2\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"xaxis\":{\"domain\":[0,0.8],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.5,10.5],\"tickmode\":\"array\",\"ticktext\":[\"Santa Cruz\",\"Tikopia\",\"Malekula\",\"Lau Fiji\",\"Tonga\",\"Hawaii\",\"Yap\",\"Chuuk\",\"Manus\",\"Trobriand\"],\"tickvals\":[1,2,3,4,5,6,7,8,9,10],\"categoryorder\":\"array\",\"categoryarray\":[\"Santa Cruz\",\"Tikopia\",\"Malekula\",\"Lau Fiji\",\"Tonga\",\"Hawaii\",\"Yap\",\"Chuuk\",\"Manus\",\"Trobriand\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":13.2835201328352},\"tickangle\":-45,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"y2\",\"title\":\"\",\"hoverformat\":\".2f\"},\"xaxis2\":{\"domain\":[0.8,1],\"automargin\":true,\"showticklabels\":false,\"showgrid\":false,\"zeroline\":false,\"anchor\":\"y2\",\"type\":\"linear\",\"autorange\":false,\"range\":[0,1.93264068051979],\"tickmode\":\"array\",\"ticktext\":[\"0.0\",\"0.5\",\"1.0\",\"1.5\"],\"tickvals\":[0,0.5,1,1.5],\"categoryorder\":\"array\",\"categoryarray\":[\"0.0\",\"0.5\",\"1.0\",\"1.5\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.65296803652968,\"tickwidth\":0,\"tickfont\":{\"color\":null,\"family\":null,\"size\":0},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"gridcolor\":null,\"gridwidth\":0,\"title\":{\"text\":\"\",\"font\":{\"color\":null,\"family\":null,\"size\":0}},\"hoverformat\":\".2f\"},\"yaxis2\":{\"domain\":[0,0.8],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.5,10.5],\"tickmode\":\"array\",\"ticktext\":[\"Santa Cruz\",\"Tikopia\",\"Malekula\",\"Lau Fiji\",\"Tonga\",\"Hawaii\",\"Yap\",\"Chuuk\",\"Manus\",\"Trobriand\"],\"tickvals\":[1,2,3,4,5,6,7,8,9,10],\"categoryorder\":\"array\",\"categoryarray\":[\"Santa Cruz\",\"Tikopia\",\"Malekula\",\"Lau Fiji\",\"Tonga\",\"Hawaii\",\"Yap\",\"Chuuk\",\"Manus\",\"Trobriand\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":13.2835201328352},\"tickangle\":-0,\"showline\":true,\"linecolor\":\"rgba(0,0,0,1)\",\"linewidth\":0.66417600664176,\"showgrid\":false,\"gridcolor\":null,\"gridwidth\":0,\"zeroline\":false,\"anchor\":\"x\",\"title\":\"\",\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0.8,1],\"automargin\":true,\"showticklabels\":false,\"showgrid\":false,\"zeroline\":false,\"anchor\":\"x\",\"type\":\"linear\",\"autorange\":false,\"range\":[0,1.93264068051979],\"tickmode\":\"array\",\"ticktext\":[\"0.0\",\"0.5\",\"1.0\",\"1.5\"],\"tickvals\":[0,0.5,1,1.5],\"categoryorder\":\"array\",\"categoryarray\":[\"0.0\",\"0.5\",\"1.0\",\"1.5\"],\"nticks\":null,\"ticks\":\"\",\"tickcolor\":null,\"ticklen\":3.65296803652968,\"tickwidth\":0,\"tickfont\":{\"color\":null,\"family\":null,\"size\":0},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"gridcolor\":null,\"gridwidth\":0,\"title\":{\"text\":\"\",\"font\":{\"color\":null,\"family\":null,\"size\":0}},\"hoverformat\":\".2f\"},\"annotations\":[],\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.8,\"y0\":0.8,\"y1\":1},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":0.8,\"y0\":0,\"y1\":0.8},{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0.8,\"x1\":1,\"y0\":0,\"y1\":0.8}],\"images\":[],\"margin\":{\"t\":30,\"r\":null,\"b\":79.7011207970112,\"l\":79.7011207970112},\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187},\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.689497716895},\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.6118721461187}},\"y\":1,\"yanchor\":\"top\"},\"hovermode\":\"closest\",\"barmode\":\"relative\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"title\":\"Correlations between Oceanic Societies in Thousands of km\"},\"attrs\":{\"1b9c7bf13ed6\":{\"xend\":{},\"yend\":{},\"colour\":{},\"linetype\":{},\"size\":{},\"x\":{},\"y\":{},\"type\":\"scatter\"},\"1b9c3f7353fd\":{\"colour\":{},\"shape\":{},\"size\":{},\"x\":{},\"y\":{}},\"1b9c1e733824\":{\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20]},\"1b9c78844e72\":{\"x\":{},\"y\":{},\"fill\":{},\"text\":{},\"type\":\"heatmap\"},\"1b9c530d10d1\":{\"x\":{},\"y\":{},\"text\":{},\"customdata\":{},\"type\":\"scatter\",\"mode\":\"text\",\"textposition\":\"middle right\",\"hovertemplate\":\"row: %{y}<br />column: %{x}<br />value: %{customdata}<extra><\\/extra>\",\"showlegend\":false,\"textfont\":{\"color\":[\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(0,0,0,1)\",\"rgba(255,255,255,1)\",\"rgba(255,255,255,1)\"],\"size\":12},\"inherit\":false},\"1b9c42f82ae3\":{\"xend\":{},\"yend\":{},\"colour\":{},\"linetype\":{},\"size\":{},\"x\":{},\"y\":{},\"type\":\"scatter\"},\"1b9c652d6138\":{\"colour\":{},\"shape\":{},\"size\":{},\"x\":{},\"y\":{}}},\"source\":\"A\",\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false,\"displaylogo\":false,\"modeBarButtonsToRemove\":[\"sendDataToCloud\",\"select2d\",\"lasso2d\",\"autoScale2d\",\"hoverClosestCartesian\",\"hoverCompareCartesian\",\"sendDataToCloud\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"subplot\":true,\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nand we add the correlations to our edges to be able to plot them\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataKline <- within(dataKline, {\n  # create the correlation dataframe\n  cor_df <- post14_08$cor\n  # set lower triangle and diagonal to 0 to avoid double values.\n  # zeros can be removed later\n  cor_df[lower.tri(cor_df, diag = FALSE)] <- NA_real_\n  cor_df <- cor_df |>\n    as.data.frame() |>\n    tibble::rownames_to_column(var = \"x\") |>\n    pivot_longer(cols = -x, names_to = \"y\", values_to = \"cor\") |>\n    # unite(col = \"id\", x, y, remove = FALSE) |>\n    # relocate(id) |>\n    # remove zeros\n    # filter(!is.na(cor)) |>\n    identity()\n  \n  # make sure you don't miss a number\n  check <- sum(post14_08$cor[lower.tri(post14_08$cor, diag = TRUE)])\n  stopifnot(sum(cor_df$cor, na.rm = TRUE) - check == 0)\n  \n  # add the correlation to the edges\n  edges_df <- edges_df |>\n    inner_join(y = cor_df, by = c(\"x\" = \"x\", \"y\" = \"y\"))\n  stopifnot(sum(edges_df$cor, na.rm = TRUE) - check == 0)\n  \n})\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngraph14_08 <- within(graph14_08, {\n  # create the graph object\n  # the manual layout requires a special treatment when using ggraph\n  # source for manual layout:\n  # https://stackoverflow.com/questions/67756538/plot-ggraph-using-supplied-node-coordinates\n  # must add the x and y coords to the nodes for manual layout to work\n  the_nodes <- dataKline$nodes_df |>\n    select(culture, x = lon2_pos, y = lat_pos, logpop)\n  the_edges <- dataKline$edges_df |>\n    filter(between(cor, 0.01, 1))\n  # the igraph object\n  grf <- the_edges |>\n    igraph::graph_from_data_frame(directed = FALSE,\n                                  vertices = the_nodes)\n  \n  # the edges' colors\n  colrs <- paletteer::paletteer_c(\"oompaBase::bluescale\", n = 16)\n  \n  # the basic graph\n  # when we use the manual layout, when the x and y have different names to avoid\n  # conflicts. See the source on manual layout mentioned above\n  p1 <- ggraph(grf, layout = data.frame(lx = NA, ly = NA)) +\n    geom_node_point(aes(size = logpop), color = \"purple\") +\n    geom_edge_link(aes(color = cor, width = cor)) +\n    ggrepel::geom_text_repel(aes(x = x, y = y, label = name), size = 3) +\n    scale_size_continuous(range = c(1, 4)) +\n    scale_edge_width(range = c(0.25, 2)) +\n    scale_edge_color_gradientn(colors = colrs) +\n    theme(legend.position = \"none\") +\n  labs(title = \"Relative positions of societies\",\n       subtitle = \"edges = correlation\",\n       x = \"longitude in thousands of km\", y = \"latitude in thousands of km\")\n  \n  # and we only need to change the nodes for the graph with tools and population\n  the_nodes <- dataKline$nodes_df |>\n    select(culture, x = logpop, y = total_tools)\n  the_edges <- dataKline$edges_df |>\n    filter(between(cor, 0.01, 1))\n  # the igraph object\n  grf <- the_edges |>\n    igraph::graph_from_data_frame(directed = FALSE,\n                                  vertices = the_nodes)\n  \n  p2 <- ggraph(grf, layout = data.frame(lx = NA, ly = NA)) +\n    geom_node_point(aes(size = x), color = \"purple\") +\n    geom_edge_link(aes(color = cor, width = cor)) +\n    ggrepel::geom_text_repel(aes(x = x, y = y, label = name), size = 3) +\n    scale_size_continuous(range = c(1, 4)) +\n    scale_edge_width(range = c(0.25, 2)) +\n    scale_edge_color_gradientn(colors = colrs) +\n    theme(legend.position = \"none\") +\n  labs(title = \"Relations between population and tools\",\n       subtitle = \"edges = correlation\",\n       x = \"log of population\", y = \"total tools\")\n})\n# glimpse(dataKline$edges_df)\n# glimpse(dataKline$nodes_df)\n# igraph::vertex.attributes(graph14_08$grf)\n# igraph::edge.attributes(graph14_08$grf)\n# graph14_08$p1\n# graph14_08$p2\nwrap_plots(graph14_08[c(\"p1\", \"p2\")]) +\n  plot_annotation(title = \"Oceanic Gaussian Process\") &\n  theme(title = element_text(color = \"darkblue\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using the `size` aesthetic in this geom was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` in the `default_aes` field and elsewhere instead.\n```\n:::\n\n::: {.cell-output-display}\n![Figure 14.12](ch14_covariances_files/figure-html/unnamed-chunk-38-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n### Phylogenic distance\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndagPhylo <- list()\ndagPhylo <- within(dagPhylo, {\n  # ggdag has no built-in method to faciliate using subscripts.\n  # This is one way to do it!\n  \n  # IMPORTANT the nodes labels must be empty\n  the_nodes <- c(\"B1\" = \"\", \n                 \"B2\" = \"\", \n                 \"G1\" = \"\", \n                 \"G2\" = \"\",\n                 \"U1\" = \"\",\n                 \"U2\" = \"\")\n  \n  # IMPORTANT: The text labels must follow the order of the nodes\n  text_labels <- c(expression(B[1]), expression(B[2]),\n                   expression(G[1]), expression(G[2]),\n                   expression(U[1]), expression(U[2]))\n  \n  dag1 <- ggdag::dagify(G2 ~ G1 + U1, B2 ~ G1 + B1 + U1, U2 ~ U1,\n                       labels = the_nodes)\n  \n  p1 <-  dag1 |>\n    ggdag::ggdag(layout = \"sugiyama\", node = FALSE) +\n    geom_dag_text(size = 8, color = \"royalblue\", \n                  parse = TRUE, label = text_labels) +\n    ggdag::theme_dag_blank(\n      panel.background = element_rect(fill = \"snow\", color = \"snow\"))\n})\ndagPhylo$p1\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in is.na(x): is.na() applied to non-(list or vector) of type\n'expression'\n```\n:::\n\n::: {.cell-output-display}\n![](ch14_covariances_files/figure-html/chap14_dagPhylo-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndagPhylo <- within(dagPhylo, {\n  dag2 <- ggdag::dagify(\n    B ~ G + M + U,\n    G ~ M + U,\n    M ~ U,\n    U ~ P\n  )\n  p2 <- dag2 |>\n    ggdag::ggdag_classic(layout = \"sugiyama\", text_col = \"royalblue\") +\n    ggdag::theme_dag_blank(\n      panel.background = element_rect(fill = \"snow\", color = \"snow\"))\n})\ndagPhylo$p2\n```\n\n::: {.cell-output-display}\n![](ch14_covariances_files/figure-html/unnamed-chunk-39-1.png){width=672}\n:::\n:::\n\n\n\n\n## Summary\n\n## Practice\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/htmlwidgets-1.5.4/htmlwidgets.js\"></script>\r\n<script src=\"site_libs/plotly-binding-4.10.1/plotly.js\"></script>\r\n<script src=\"site_libs/typedarray-0.1/typedarray.min.js\"></script>\r\n<script src=\"site_libs/jquery-3.5.1/jquery.min.js\"></script>\r\n<link href=\"site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\r\n<link href=\"site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\r\n<script src=\"site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}